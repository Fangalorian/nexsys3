/*! For license information please see bundle.min.js.LICENSE.txt */
!function(){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return generator._invoke=function(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}(innerFn,self,context),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;this._invoke=function(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(void 0===method){if(context.delegate=null,"throw"===context.method){if(delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method))return ContinueSentinel;context.method="throw",context.arg=new TypeError("The iterator does not provide a 'throw' method")}return ContinueSentinel}var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(Gp,"constructor",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(object){var keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function _wrapNativeSuper(Class){if(null===Class||!function _isNativeFunction(fn){return-1!==Function.toString.call(fn).indexOf("[native code]")}(Class))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)},_wrapNativeSuper(Class)}function _construct(Parent,args,Class){return _construct=_isNativeReflectConstruct()?Reflect.construct.bind():function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(instance,Class.prototype),instance},_construct.apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var EventStream=function(_EventTarget){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(EventStream,_EventTarget);var _super=function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}(EventStream);function EventStream(){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,EventStream),(_this=_super.call(this)).stream={},_this.gmcpBackLog=[],_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(EventStream,[{key:"registerEvent",value:function registerEvent(event,callback){var once=arguments.length>2&&void 0!==arguments[2]&&arguments[2];void 0===this.stream[event]&&(this.stream[event]=[]),this.addEventListener(event,function(){var _ref2=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(_ref){var detail;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:detail=_ref.detail,callback(detail);case 2:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref2.apply(this,arguments)}}(),{once:once}),this.stream[event].push(callback)}},{key:"raiseEvent",value:function raiseEvent(event,data){this.dispatchEvent(new CustomEvent(event,{detail:data}))}},{key:"removeListener",value:function removeListener(event,listener){var streamEvent=this.stream[event];if(void 0!==streamEvent){if("string"==typeof listener){var listenerIndex=streamEvent.findIndex((function(e){return e.name===listener}));listenerIndex>=0&&(this.removeEventListener(event,streamEvent[listenerIndex]),streamEvent.splice(listenerIndex,1))}else streamEvent=streamEvent.filter((function(e){return e!==listener})),this.removeEventListener(event,listener);this.stream[event]=streamEvent}}}]),EventStream}(_wrapNativeSuper(EventTarget)),eventStream_eventStream=new EventStream;function trackable_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var trackable=function(){function Trackable(name){!function trackable_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Trackable),this._name=name,this._status=!1,this._got_time=0,this._lost_time=0,eventStream_eventStream.registerEvent(name+"LostTrackableEvent",this.lost.bind(this)),eventStream_eventStream.registerEvent(name+"GotTrackableEvent",this.got.bind(this))}return function trackable_createClass(Constructor,protoProps,staticProps){return protoProps&&trackable_defineProperties(Constructor.prototype,protoProps),staticProps&&trackable_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Trackable,[{key:"have",get:function get(){return this._status}},{key:"name",get:function get(){return this._name}},{key:"raiseEventGot",value:function raiseEventGot(){eventStream_eventStream.raiseEvent("TrackableGot",this)}},{key:"raiseEventLost",value:function raiseEventLost(){eventStream_eventStream.raiseEvent("TrackableLost",this)}},{key:"got",value:function got(){this._status=!0,this._got_time=performance.now(),this.raiseEventGot()}},{key:"lost",value:function lost(){this._status=!1,this._lost_time=performance.now(),this.raiseEventLost()}},{key:"elapsed",value:function elapsed(){return this._status?(performance.now()-this._got_time)/1e3:0}}]),Trackable}();function priority_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function priority_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Priority=function(){function Priority(name){var prio=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;priority_classCallCheck(this,Priority),this._name=name,this._default=prio,this._current=prio,this._prev=prio}return function priority_createClass(Constructor,protoProps,staticProps){return protoProps&&priority_defineProperties(Constructor.prototype,protoProps),staticProps&&priority_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Priority,[{key:"name",get:function get(){return this._name}},{key:"prio",get:function get(){return this._current}},{key:"defaultPrio",get:function get(){return this._default}},{key:"raiseEventPrioSet",value:function raiseEventPrioSet(){eventStream_eventStream.raiseEvent("PrioritySetEvent",this)}},{key:"raiseEventPrioReset",value:function raiseEventPrioReset(){eventStream_eventStream.raiseEvent("PriorityResetEvent",this)}},{key:"raiseEventPrioSetDefault",value:function raiseEventPrioSetDefault(){eventStream_eventStream.raiseEvent("PrioritySetDefaultEvent",this)}},{key:"setPrio",value:function setPrio(prio){this._prev=this.prio,this._current=prio,this._current!==this._prev&&this.raiseEventPrioSet()}},{key:"reset",value:function reset(){this.setPrio(this.defaultPrio),this._current!==this._prev&&this.raiseEventPrioReset()}},{key:"setDefault",value:function setDefault(prio){this._default=prio,this.setPrio(prio),this.raiseEventPrioSetDefault()}}]),Priority}(),priority=Priority;function countable_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function countable_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Countable=function(){function Countable(name){var min=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,max=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;countable_classCallCheck(this,Countable),this._name=name,this._min=min,this._max=max,this._count=this._min,this._prev=this._count}return function countable_createClass(Constructor,protoProps,staticProps){return protoProps&&countable_defineProperties(Constructor.prototype,protoProps),staticProps&&countable_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Countable,[{key:"count",get:function get(){return this._count}},{key:"name",get:function get(){return this._name}},{key:"min",get:function get(){return this._min}},{key:"max",get:function get(){return this._max}},{key:"raiseEventCountableUp",value:function raiseEventCountableUp(){eventStream_eventStream.raiseEvent("CountableUpEvent",this)}},{key:"raiseEventCountableDown",value:function raiseEventCountableDown(){eventStream_eventStream.raiseEvent("CountableDownEvent",this)}},{key:"raiseEventCountableSet",value:function raiseEventCountableSet(){eventStream_eventStream.raiseEvent("CountableSetEvent",this)}},{key:"raiseEventCountableReset",value:function raiseEventCountableReset(){eventStream_eventStream.raiseEvent("CountableResetEvent",this)}},{key:"checkLimits",value:function checkLimits(num){return num>this._max?this._max:num<this._min?this._min:num}},{key:"setCount",value:function setCount(num){return this._prev=this._count,this._count=num,this.raiseEventCountableSet(),this._count}},{key:"reset",value:function reset(){return this.setCount(this._min),this.raiseEventCountableReset(),this._count}},{key:"add",value:function add(){var num=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.setCount(this.checkLimits(this._count+num)),this.raiseEventCountableUp(),this._count}},{key:"subtract",value:function subtract(){var num=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.setCount(this.checkLimits(this._count-num)),this.raiseEventCountableDown(),this._count}}]),Countable}(),countable=Countable;function timer_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function timer_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Timer=function(){function Timer(name){var length=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;timer_classCallCheck(this,Timer),this._name=name,this._enabled=!1,this._t_started=0,this._t_ended=0,this._timerId=0,this._default_length=length,this.setLength(length),this._callbacks=[]}return function timer_createClass(Constructor,protoProps,staticProps){return protoProps&&timer_defineProperties(Constructor.prototype,protoProps),staticProps&&timer_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Timer,[{key:"length",get:function get(){return this._t_length}},{key:"setLength",value:function setLength(length){this._t_length=length,this._t_length_ms=1e3*length}},{key:"reset",value:function reset(){this.setLength(this._default_length)}},{key:"start",value:function start(){this._enabled&&clearTimeout(this._timerId),this._timerId=setTimeout(this.stop.bind(this),this._t_length_ms),this._t_started=performance.now()/1e3,this._enabled=!0}},{key:"stop",value:function stop(){if(this._enabled&&(clearTimeout(this._timerId),this._t_ended=performance.now()/1e3,this._enabled=!1,this._callbacks))for(var i=0;i<this._callbacks.length;i++)this._callbacks[i](this._t_ended-this._t_started)}},{key:"duration",value:function duration(){return this._enabled?this.elapsed():this._t_ended-this._t_started}},{key:"elapsed",value:function elapsed(){return this._enabled?performance.now()/1e3-this._t_started:0}},{key:"remaining",value:function remaining(){return this._enabled?this._t_length-performance.now()/1e3-this._t_started:0}},{key:"addCallback",value:function addCallback(callback){this._callbacks.push(callback)}},{key:"clearCallbacks",value:function clearCallbacks(){this._callbacks=[]}}]),Timer}(),timer=Timer;function aff_typeof(obj){return aff_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},aff_typeof(obj)}function aff_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function aff_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function aff_createClass(Constructor,protoProps,staticProps){return protoProps&&aff_defineProperties(Constructor.prototype,protoProps),staticProps&&aff_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(target,property,receiver){var base=_superPropBase(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(arguments.length<3?target:receiver):desc.value}},_get.apply(this,arguments)}function _superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=aff_getPrototypeOf(object)););return object}function aff_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&aff_setPrototypeOf(subClass,superClass)}function aff_setPrototypeOf(o,p){return aff_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},aff_setPrototypeOf(o,p)}function aff_createSuper(Derived){var hasNativeReflectConstruct=function aff_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=aff_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=aff_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return aff_possibleConstructorReturn(this,result)}}function aff_possibleConstructorReturn(self,call){if(call&&("object"===aff_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return aff_assertThisInitialized(self)}function aff_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function aff_getPrototypeOf(o){return aff_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},aff_getPrototypeOf(o)}for(var Aff=function(_Trackable){aff_inherits(Aff,_Trackable);var _super=aff_createSuper(Aff);function Aff(name){var _this,prio=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,uncurable=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return aff_classCallCheck(this,Aff),(_this=_super.call(this,name))._prio=new priority(_this._name,prio),_this._cures=[],_this._serverside=!1,prio>=0&&prio<=26&&(_this._serverside=!0),_this._uncurable=uncurable,_this.registerEvents(),_this}return aff_createClass(Aff,[{key:"registerEvents",value:function registerEvents(){eventStream_eventStream.registerEvent(this.name+"LostAffEvent",this.lost.bind(this)),eventStream_eventStream.registerEvent(this.name+"GotAffEvent",this.got.bind(this))}},{key:"isUncurable",get:function get(){return this._uncurable}},{key:"isServerSide",get:function get(){return this._serverside}},{key:"cures",get:function get(){return this._cures}},{key:"prio",get:function get(){return this._prio.prio}},{key:"raiseEventGot",value:function raiseEventGot(){eventStream_eventStream.raiseEvent("AffGot",this)}},{key:"raiseEventLost",value:function raiseEventLost(){eventStream_eventStream.raiseEvent("AffLost",this)}},{key:"raiseEventSet",value:function raiseEventSet(){this.isUncurable||eventStream_eventStream.raiseEvent("AffPrioritySetEvent",this)}},{key:"got",value:function got(){this.have||_get(aff_getPrototypeOf(Aff.prototype),"got",this).call(this)}},{key:"lost",value:function lost(){this.have&&_get(aff_getPrototypeOf(Aff.prototype),"lost",this).call(this)}},{key:"addCure",value:function addCure(cure){this._cures.push(cure)}},{key:"set_prio",value:function set_prio(prio){this._prio.setPrio(prio),this.raiseEventSet()}},{key:"set_default_prio",value:function set_default_prio(prio){this._prio.setDefault(prio),this.set_prio(prio)}},{key:"toggle_default_prio",value:function toggle_default_prio(prio){this._prio.prio===prio?this.set_default_prio(0):this.set_default_prio(prio)}},{key:"reset_prio",value:function reset_prio(){this._prio.reset(),this.raiseEventSet()}}]),Aff}(trackable),AffCountable=function(_Aff){aff_inherits(AffCountable,_Aff);var _super2=aff_createSuper(AffCountable);function AffCountable(name,prio){var _this2,min=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,max=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,uncurable=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return aff_classCallCheck(this,AffCountable),(_this2=_super2.call(this,name,prio,uncurable))._count=new countable(_this2._name,min,max),_this2}return aff_createClass(AffCountable,[{key:"registerEvents",value:function registerEvents(){_get(aff_getPrototypeOf(AffCountable.prototype),"registerEvents",this).call(this),eventStream_eventStream.registerEvent(this.name+"AffCountSubtractEvent",this.subtract.bind(this)),eventStream_eventStream.registerEvent(this.name+"AffCountAddEvent",this.add.bind(this)),eventStream_eventStream.registerEvent(this.name+"AffCountSetEvent",this.setCount.bind(this))}},{key:"count",get:function get(){return this._count.count}},{key:"min",get:function get(){return this._count.min}},{key:"max",get:function get(){return this._count.max}},{key:"setCount",value:function setCount(num){this._count.setCount(num)}},{key:"lost",value:function lost(){this.setCount(this.min),_get(aff_getPrototypeOf(AffCountable.prototype),"lost",this).call(this)}},{key:"add",value:function add(){var num=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,count=this._count.add(num);count>this.min&&!this.have&&this.got()}},{key:"subtract",value:function subtract(){var num=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,count=this._count.subtract(num);count===this.min&&this.lost()}}]),AffCountable}(Aff),AffTimed=function(_Aff2){aff_inherits(AffTimed,_Aff2);var _super3=aff_createSuper(AffTimed);function AffTimed(name,prio){var _this3,length=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,uncurable=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return aff_classCallCheck(this,AffTimed),(_this3=_super3.call(this,name,prio,uncurable))._timer=new timer(_this3._name,length),_this3._timer.addCallback(_this3.lost.bind(aff_assertThisInitialized(_this3))),_this3}return aff_createClass(AffTimed,[{key:"got",value:function got(){this._timer.start(),_get(aff_getPrototypeOf(AffTimed.prototype),"got",this).call(this)}},{key:"lost",value:function lost(){this._timer.stop(),_get(aff_getPrototypeOf(AffTimed.prototype),"lost",this).call(this)}}]),AffTimed}(Aff),AffDef=function(_Aff3){aff_inherits(AffDef,_Aff3);var _super4=aff_createSuper(AffDef);function AffDef(name){var prio=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,uncurable=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return aff_classCallCheck(this,AffDef),_super4.call(this,name,prio,uncurable)}return aff_createClass(AffDef,[{key:"registerEvents",value:function registerEvents(){eventStream_eventStream.registerEvent(this.name+"LostAffEvent",this.got.bind(this)),eventStream_eventStream.registerEvent(this.name+"GotAffEvent",this.lost.bind(this)),eventStream_eventStream.registerEvent(this.name+"LostDefEvent",this.got.bind(this)),eventStream_eventStream.registerEvent(this.name+"GotDefEvent",this.lost.bind(this))}},{key:"raiseEventSet",value:function raiseEventSet(){this.isUncurable||eventStream_eventStream.raiseEvent("DefPrioritySetEvent",this)}}]),AffDef}(Aff),affs={list:["addiction","aeon","agoraphobia","airfisted","amnesia","anorexia","asphyxiating","asthma","blackout","bleeding","blindness","blistered","bloodfire","bound","brokenleftarm","brokenrightarm","brokenleftleg","brokenrightleg","bruisedribs","burning","cadmuscurse","calcifiedskull","calcifiedtorso","claustrophobia","clumsiness","coldfate","concussion","conflagration","confusion","corruption","crackedribs","cremated","crushedthroat","daeggerimpale","damagedhead","damagedleftarm","damagedleftleg","damagedrightarm","damagedrightleg","darkshade","dazed","dazzled","deadening","deafness","death","deepsleep","degenerate","dehydrated","dementia","demonstain","depression","deteriorate","disloyalty","disrupted","dissonance","dizziness","enlightenment","enmesh","ensorcelled","entangled","epilepsy","fear","flamefisted","flushings","frozen","generosity","grievouswounds","guilt","hamstrung","haemophilia","hallucinations","hatred","healthleech","heartseed","hecatecurse","hellsight","hindered","homunculusmercury","horror","hypersomnia","hypochondria","hypothermia","icefisted","impaled","impatience","indifference","inquisition","insomnia","internalbleeding","isolation","itching","justice","kaisurge","kkractlebrand","laceratedthroat","lapsingconsciousness","latched","lethargy","lightbind","loneliness","lovers","lullaby","manaleech","masochism","mildtrauma","mangledleftarm","mangledleftleg","mangledrightarm","mangledrightleg","mangledhead","mindclamp","mindravaged","muddled","mycalium","nausea","numbedleftarm","numbedrightarm","pacified","palpatarfeed","paralysis","paranoia","parasite","peace","penitence","petrified","phlogisticated","pinshot","pressure","prone","pyramides","pyre","rebbies","recklessness","retribution","revealed","sandfever","scalded","scrambledbrains","scytherus","selarnia","sensitivity","serioustrauma","shadowmadness","shivering","shyness","silenced","silver","skullfractures","slashedthroat","sleeping","slickness","slimeobscure","solarburn","spiritburn","stun","stupidity","stuttering","temperedcholeric","temperedmelancholic","temperedphlegmatic","temperedsanguine","tenderskin","tension","timeflux","timeloop","tonguetied","torntendons","transfixation","trueblind","unweavingbody","unweavingmind","unweavingspirit","vertigo","vinewreathed","vitiated","vitrified","voidfisted","voyria","waterbonds","weakenedmind","weariness","webbed","whisperingmadness","wristfractures","unconsciousness","harmonic","bop","spiritwrack","bedevil","loki","moon","evileye","dragoncurse","swiftcurse"],prios:{airfisted:0,asphyxiating:0,blistered:0,bloodfire:0,bruisedribs:0,cadmuscurse:0,coldfate:0,conflagration:0,corruption:0,cremated:0,death:0,degenerate:0,dehydrated:0,demonstain:0,deteriorate:0,enlightenment:0,enmesh:0,ensorcelled:0,flamefisted:0,hamstrung:0,hatred:0,hecatecurse:0,hindered:0,homunculusmercury:0,icefisted:0,internalbleeding:0,inquisition:0,lightbind:0,lullaby:0,muddled:0,numbedleftarm:0,numbedrightarm:0,palpatarfeed:0,phlogisticated:0,pinshot:0,slimeobscure:0,stun:0,timeflux:0,trueblind:0,vinewreathed:0,voidfisted:0,weakenedmind:0,unconsciousness:0,aeon:2,concussion:2,anorexia:2,sleeping:2,heartseed:3,paralysis:3,guilt:3,skullfractures:3,hypothermia:4,impatience:4,torntendons:4,pyramides:5,mycalium:5,flushings:5,rebbies:5,parasite:5,sandfever:5,hypochondria:5,lovers:5,itching:5,pacified:5,peace:5,scytherus:5,asthma:6,bound:6,daeggerimpale:6,clumsiness:6,entangled:6,impaled:6,sensitivity:6,transfixation:6,weariness:6,webbed:6,damagedleftleg:7,damagedrightleg:7,darkshade:7,mangledleftleg:7,mangledrightleg:7,brokenleftleg:8,brokenrightleg:8,confusion:8,hallucinations:8,hypersomnia:8,disrupted:9,mangledhead:9,prone:9,stupidity:9,voyria:9,airdisrupt:10,brokenleftarm:10,brokenrightarm:10,slickness:10,waterdisrupt:10,wristfractures:10,indifference:11,retribution:11,shadowmadness:11,addiction:11,crackedribs:11,haemophilia:11,lethargy:11,nausea:11,whisperingmadness:11,damagedhead:12,hellsight:12,recklessness:12,damagedleftarm:13,damagedrightarm:13,healthleech:13,manaleech:13,temperedcholeric:13,temperedmelancholic:13,temperedphlegmatic:13,temperedsanguine:13,disloyalty:14,dissonance:14,dizziness:14,mangledleftarm:14,mangledrightarm:14,shyness:14,agoraphobia:15,claustrophobia:15,deadening:15,frozen:15,generosity:15,justice:15,loneliness:15,shivering:15,vertigo:15,dementia:16,mildtrauma:16,paranoia:16,serioustrauma:16,epilepsy:17,burning:18,laceratedthroat:18,slashedthroat:18,stuttering:18,selarnia:19,fear:20,masochism:20,scalded:20,dazed:20,bleeding:30,amnesia:30,blackout:30,insomnia:10,deafness:21,blindness:22,harmonic:100,bop:100,spiritwrack:100,bedevil:100,loki:100,moon:100,evileye:100,dragoncurse:100,swiftcurse:100},types:{defs:{blindness:!0,deafness:!0,insomnia:!0},countable:{bleeding:{min:0,max:15e3},burning:{min:0,max:5},crackedribs:{min:0,max:7},horror:{min:0,max:7},skullfractures:{min:0,max:7},temperedcholeric:{min:0,max:8},temperedmelancholic:{min:0,max:8},temperedphlegmatic:{min:0,max:8},temperedsanguine:{min:0,max:8},torntendons:{min:0,max:7},wristfractures:{min:0,max:7}},timed:{aeon:{length:16},airfisted:{length:16},blackout:{length:10},bruisedribs:{length:30},cadmuscurse:{length:20},constricted:{length:30},corruption:{length:45},dazzled:{length:60},dehydrated:{length:60},demonstain:{length:120},enmesh:{length:5},ensorcelled:{length:20},flamefisted:{length:30},hamstrung:{length:9},heartseed:{length:11},hecatecurse:{length:16},icefisted:{length:30},internalbleeding:{length:30},inquisition:{length:30},lightbind:{length:22},mudded:{length:12},numbedleftarm:{length:7.5},numbedrightarm:{length:7.5},phlogisticated:{length:45},pinshot:{length:18},slimeobscure:{length:60},stun:{length:3},timeflux:{length:60},trueblind:{length:6},unconsciousness:{length:10},vinewreathed:{length:30},voidfisted:{length:5},weakenedmind:{length:60}},unknown:{moon:["stupidity","confusion","epilepsy","masochism","hypersomnia","hallucinations"],loki:["stupidity","clumsiness","recklessness","asthma","shyness","darkshade","paralysis","brokenleftarm","brokenrightarm","brokenleftleg","brokenrightleg","sensitivity","disloyalty","nausea","weariness","dizziness","anorexia","voyria","haemophilia","addiction","selarnia","slickness","scytherus"],evileye:["confusion","dizziness"],dragoncurse:["recklessness","clumsiness","epilepsy","dizziness","pacifism","nausea","addiction","anorexia","generosity","disloyalty","sensitivity","vertigo","paranoia","stupidity","hypochondria","lethargy","shivering","frozen","impatience","paralysis","asthma","agoraphobia"],harmonic:["stupidity","recklessness"],bop:["stupidity","recklessness"],swiftcurse:["stupidity","clumsiness","recklessness","asthma","paralysis","deafness","sensitivity","nausea","weariness","dizziness","anorexia","voyria","haemophilia","addiction","impatience","claustrophobia","vertigo","agoraphobia","masochism","epilepsy","manaleech","pacifism","dementia","healthleech"],bedevil:["stupidity","recklessness"]},uncurable:{bloodfire:!0,cadmuscurse:!0,conflagration:!0,death:!0,deathsickness:!0,deepsleep:!0,enlightenment:!0,insomnia:!0,isolation:!0,lullaby:!0,mindclamp:!0,mindisolation:!0,palpatarfeed:!0,penitence:!0,stun:!0,weakenedmind:!0}}},Affs={},affs_affs=affs,i=0;i<affs_affs.list.length;i++){var affname=affs_affs.list[i],count=affs_affs.types.countable[affname],timed=affs_affs.types.timed[affname],defs=affs_affs.types.defs[affname],prio=affs_affs.prios[affname],uncurable=affs_affs.types.uncurable[affname];Affs[affname]=count?new AffCountable(affname,prio,count.min,count.max,uncurable):timed?new AffTimed(affname,prio,timed.length,uncurable):defs?new AffDef(affname,prio,uncurable):new Aff(affname,prio,uncurable)}function getCurrentAffs(){var affs=Affs;return Object.keys(affs).filter((function(aff){return!0===affs[aff].have})).sort((function(a,b){return affs[a].prio-affs[b].prio}))}function haveAff(aff){var curAff=Affs[aff];return void 0!==aff&&void 0!==curAff&&curAff.have}function balance_typeof(obj){return balance_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},balance_typeof(obj)}function balance_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function balance_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function balance_createClass(Constructor,protoProps,staticProps){return protoProps&&balance_defineProperties(Constructor.prototype,protoProps),staticProps&&balance_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function balance_get(){return balance_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(target,property,receiver){var base=balance_superPropBase(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(arguments.length<3?target:receiver):desc.value}},balance_get.apply(this,arguments)}function balance_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=balance_getPrototypeOf(object)););return object}function balance_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&balance_setPrototypeOf(subClass,superClass)}function balance_setPrototypeOf(o,p){return balance_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},balance_setPrototypeOf(o,p)}function balance_createSuper(Derived){var hasNativeReflectConstruct=function balance_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=balance_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=balance_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return balance_possibleConstructorReturn(this,result)}}function balance_possibleConstructorReturn(self,call){if(call&&("object"===balance_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function balance_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function balance_getPrototypeOf(o){return balance_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},balance_getPrototypeOf(o)}eventStream_eventStream.registerEvent("CuresCreatedEvent",(function addCuresToAffs(cures){for(var cure in cures){var order=cures[cure].order;if(void 0!==order)for(var _i=0;_i<order.length;_i++)Affs[order[_i]].addCure(cure)}}));var Balance=function(_Trackable){balance_inherits(Balance,_Trackable);var _super=balance_createSuper(Balance);function Balance(name){var _this,length=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60;return balance_classCallCheck(this,Balance),(_this=_super.call(this,name))._length=length,_this._timer=new timer(_this._name,_this._length),_this._status=!0,_this.registerEvents(),_this}return balance_createClass(Balance,[{key:"duration",get:function get(){return this._timer.duration()}},{key:"registerEvents",value:function registerEvents(){eventStream_eventStream.registerEvent(this.name+"LostBalEvent",this.lost.bind(this)),eventStream_eventStream.registerEvent(this.name+"GotBalEvent",this.got.bind(this))}},{key:"raiseEventGot",value:function raiseEventGot(){eventStream_eventStream.raiseEvent("BalanceGot",this)}},{key:"raiseEventLost",value:function raiseEventLost(){eventStream_eventStream.raiseEvent("BalanceLost",this)}},{key:"got",value:function got(){this.have||(this.clearCallbacks(),this._timer.stop(),balance_get(balance_getPrototypeOf(Balance.prototype),"got",this).call(this))}},{key:"lost",value:function lost(){this.have&&(this.addCallback(this.got.bind(this)),this._timer.start(),balance_get(balance_getPrototypeOf(Balance.prototype),"lost",this).call(this))}},{key:"on",value:function on(){this.have||this.got()}},{key:"off",value:function off(){this.have&&this.lost()}},{key:"setTimer",value:function setTimer(length){this._timer.setLength(length)}},{key:"resetTimer",value:function resetTimer(){this._timer.reset()}},{key:"addCallback",value:function addCallback(callback){this._timer.addCallback(callback)}},{key:"clearCallbacks",value:function clearCallbacks(){this._timer.clearCallbacks()}}]),Balance}(trackable),BalExtended=function(_Balance){balance_inherits(BalExtended,_Balance);var _super2=balance_createSuper(BalExtended);function BalExtended(name,length,obj){var _this2;return balance_classCallCheck(this,BalExtended),(_this2=_super2.call(this,name,length))._aff_modifiers=obj.aff_modifiers,_this2._mods={},_this2.registerAffModifiers(),_this2}return balance_createClass(BalExtended,[{key:"registerAffModifiers",value:function registerAffModifiers(){for(var name in this._aff_modifiers)this._mods[name]=!1,eventStream_eventStream.registerEvent(name+"LostAffEvent",this.removeModifier.bind(this)),eventStream_eventStream.registerEvent(name+"GotAffEvent",this.addModifier.bind(this))}},{key:"removeModifier",value:function removeModifier(aff){this._mods[aff]=!1}},{key:"addModifier",value:function addModifier(aff){this._mods[aff]=!0}},{key:"got",value:function got(){this.resetTimer(),balance_get(balance_getPrototypeOf(BalExtended.prototype),"got",this).call(this)}},{key:"lost",value:function lost(){for(var length=this._length,i=0;i<this._mods;i++){var affMod=this._aff_modifiers[this._mods[i]];length*=affMod.multiplier,length+=affMod.offset}this.setTimer(length),balance_get(balance_getPrototypeOf(BalExtended.prototype),"lost",this).call(this)}}]),BalExtended}(Balance),balances={herb:{length:1.6,aff_modifiers:{homunculusmercury:{multiplier:1,offset:.5}}},focus:{length:2.5,aff_modifiers:{weakenedmind:{multiplier:2,offset:.5}}},sip:{length:4.5,aff_modifiers:{skullfractures:{multiplier:1,offset:1}}},moss:{length:6},tree:{length:15,aff_modifiers:{slimeobscure:{multiplier:1,offset:10}}},equilibrium:{length:20,aff_modifiers:{confusion:{multiplier:1.5,offset:0}}},balance:{length:20,aff_modifiers:{lethargy:{multiplier:1.25,offset:0}}},salve:{length:1,aff_modifiers:{timeflux:{multiplier:1.5,offset:0}}},immunity:{length:10},rebounding:{length:9},smoke:{length:1.5},dragonbreath:{length:1.5},deafness:{length:3},deaf:{length:6},blind:{length:6},speed:{length:6},wake:{length:20},sileris:{length:8},free:{length:0},voice:{length:2.5},tremolo:{length:6},homunculus:{length:12},fitness:{length:10},bloodboil:{length:10},dragonheal:{length:20},rage:{length:10},salt:{length:10},shrugging:{length:12},slough:{length:10},fool:{length:40},writhe:{length:6},impalewrithe:{length:4},entity:{length:4}},Bals={};for(var bal in balances){var obj={},balances_length=balances[bal].length;balances[bal].aff_modifiers?(obj.aff_modifiers=balances[bal].aff_modifiers,Bals[bal]=new BalExtended(bal,balances_length,obj)):Bals[bal]=new Balance(bal,balances_length)}function haveBal(bal){var curBal=Bals[bal];return void 0!==bal&&void 0!==curBal&&curBal.have}eventStream_eventStream.registerEvent("Char.Vitals",(function eventGmcpBalances(vitals){"1"===vitals.bal?(!haveBal("balance")&&haveBal("equilibrium")&&eventStream_eventStream.raiseEvent("eqBalRecoveredEvent"),eventStream_eventStream.raiseEvent("balanceGotBalEvent")):eventStream_eventStream.raiseEvent("balanceLostBalEvent"),"1"===vitals.eq?(!haveBal("equilibrium")&&haveBal("balance")&&eventStream_eventStream.raiseEvent("eqBalRecoveredEvent"),eventStream_eventStream.raiseEvent("equilibriumGotBalEvent")):eventStream_eventStream.raiseEvent("equilibriumLostBalEvent")}));var herb_name_to_herb={"a magnesium chip":"magnesium","an aurum flake":"aurum","a plumbum flake":"plumbum","a stannum flake":"stannum","an arsenic pellet":"arsenic","a ferrum flake":"ferrum","an antimony flake":"antimony","a cuprum flake":"cuprum","an argentum flake":"argentum","a calamine crystal":"calamine","a pinch of ground cinnabar":"cinnabar","a pinch of realgar crystals":"realgar","a quartz grain":"quartz","a pinch of ground malachite":"malachite","a quicksilver droplet":"quicksilver","a potash crystal":"potash","a gypsum crystal":"gypsum","a bloodroot leaf":"bloodroot","a piece of kelp":"kelp","a goldenseal root":"goldenseal","some prickly ash bark":"ash","some bayberry bark":"bayberry","a ginseng root":"ginseng","a ginger root":"ginger","a bellwort flower":"bellwort","a lobelia seed":"lobelia","a hawthorn berry":"hawthorn","a valerian leaf":"valerian","a skullcap flower":"skullcap","slippery elm":"elm","a kola nut":"kola","sileris berry":"sileris","some irid moss":"moss","a black cohosh root":"cohosh","magnesium chips":"magnesium","aurum flakes":"aurum","plumbum flakes":"plumbum","stannum flakes":"stannum","arsenic pellets":"arsenic","ferrum flakes":"ferrum","antimony flakes":"antimony","cuprum flakes":"cuprum","argentum flakes":"argentum","calamine crystals":"calamine","pinches of ground cinnabar":"cinnabar","pinches of ground realgar":"realgar","quartz grains":"quartz","pinches of ground malachite":"malachite","quicksilver droplets":"quicksilver","potash crystals":"potash","gypsum crystals":"gypsum","bloodroot leaves":"bloodroot","pieces of kelp":"kelp","goldenseal roots":"goldenseal","pieces of prickly ash bark":"ash","pieces of bayberry bark":"bayberry","ginseng roots":"ginseng","ginger roots":"ginger","bellwort flowers":"bellwort","lobelia seeds":"lobelia","hawthorn berries":"hawthorn","valerian leaves":"valerian","skullcap flowers":"skullcap","slippery elms":"elm","kola nuts":"kola","sileris berries":"sileris","pieces of irid moss":"moss","cohosh roots":"cohosh"},cacheTable={magnesium:0,plumbum:0,arsenic:0,potash:0,stannum:0,malachite:0,realgar:0,cinnabar:0,antimony:0,ferrum:0,quartz:0,quicksilver:0,aurum:0,calamine:0,cuprum:0,argentum:0,gypsum:0,ginseng:0,bloodroot:0,kelp:0,hawthorn:0,lobelia:0,bellwort:0,ginger:0,bayberry:0,ash:0,goldenseal:0,moss:0,valerian:0,elm:0,skullcap:0,sileris:0,kola:0,cohosh:0};function cache_typeof(obj){return cache_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},cache_typeof(obj)}function cache_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function cache_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function cache_setPrototypeOf(o,p){return cache_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},cache_setPrototypeOf(o,p)}function cache_createSuper(Derived){var hasNativeReflectConstruct=function cache_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=cache_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=cache_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return cache_possibleConstructorReturn(this,result)}}function cache_possibleConstructorReturn(self,call){if(call&&("object"===cache_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function cache_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function cache_getPrototypeOf(o){return cache_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},cache_getPrototypeOf(o)}var Cache=function(_Trackable){!function cache_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&cache_setPrototypeOf(subClass,superClass)}(Cache,_Trackable);var _super=cache_createSuper(Cache);function Cache(name){var _this,amount=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,obj=arguments.length>2?arguments[2]:void 0;return cache_classCallCheck(this,Cache),(_this=_super.call(this,name))._blocks=obj.blocks||[],_this._amount=amount,_this._count=new countable(_this._name,0,2e4),_this._rift=0,_this.registerEvents(),_this}return function cache_createClass(Constructor,protoProps,staticProps){return protoProps&&cache_defineProperties(Constructor.prototype,protoProps),staticProps&&cache_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Cache,[{key:"blocks",get:function get(){return this._blocks}},{key:"amount",get:function get(){return this._amount}},{key:"command",get:function get(){return"outr "+(this.amount-this.count)+" "+this.name}},{key:"count",get:function get(){return this._count.count}},{key:"rift",get:function get(){return this._rift}},{key:"needToOutr",get:function get(){return this.rift>=this.amount&&this.count<this.amount}},{key:"registerEvents",value:function registerEvents(){eventStream_eventStream.registerEvent(this.name+"CacheCountSubtractEvent",this.subtract.bind(this)),eventStream_eventStream.registerEvent(this.name+"CacheCountAddEvent",this.add.bind(this)),eventStream_eventStream.registerEvent(this.name+"CacheCountResetEvent",this.reset.bind(this)),eventStream_eventStream.registerEvent(this.name+"RiftSetEvent",this.riftSet.bind(this))}},{key:"setCount",value:function setCount(num){return this._count.setCount(num)}},{key:"add",value:function add(){var num=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this._count.add(num)}},{key:"subtract",value:function subtract(){var num=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this._count.subtract(num)}},{key:"reset",value:function reset(){return this.setCount(0)}},{key:"riftSet",value:function riftSet(num){this._rift=num,eventStream_eventStream.raiseEvent("RiftSetEvent",this)}}]),Cache}(trackable);function def_typeof(obj){return def_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},def_typeof(obj)}function def_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function def_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function def_createClass(Constructor,protoProps,staticProps){return protoProps&&def_defineProperties(Constructor.prototype,protoProps),staticProps&&def_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function def_get(){return def_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(target,property,receiver){var base=def_superPropBase(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(arguments.length<3?target:receiver):desc.value}},def_get.apply(this,arguments)}function def_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=def_getPrototypeOf(object)););return object}function def_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&def_setPrototypeOf(subClass,superClass)}function def_setPrototypeOf(o,p){return def_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},def_setPrototypeOf(o,p)}function def_createSuper(Derived){var hasNativeReflectConstruct=function def_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=def_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=def_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return def_possibleConstructorReturn(this,result)}}function def_possibleConstructorReturn(self,call){if(call&&("object"===def_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function def_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function def_getPrototypeOf(o){return def_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},def_getPrototypeOf(o)}var Def=function(_Trackable){def_inherits(Def,_Trackable);var _super=def_createSuper(Def);function Def(name){var _this,prio=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,obj=arguments.length>2?arguments[2]:void 0;return def_classCallCheck(this,Def),(_this=_super.call(this,name))._prio=new priority(_this._name,prio),_this._command=obj.command||"",_this._bals_req=obj.bals_req||[],_this._bals_used=obj.bals_used||[],_this._blocks=obj.blocks||[],_this._skills=obj.skills||[],_this._preempt=obj.preempt||!1,_this._opps=obj.opps,_this.registerEvents(),_this}return def_createClass(Def,[{key:"isServerSide",get:function get(){return!1}},{key:"prio",get:function get(){return this._prio.prio}},{key:"isIgnored",get:function get(){return 0===this._prio.prio}},{key:"balsUsed",get:function get(){return this._bals_used}},{key:"balsReq",get:function get(){return this._bals_req}},{key:"blocks",get:function get(){return this._blocks}},{key:"command",get:function get(){return this._command}},{key:"skills",get:function get(){return this._skills}},{key:"preempt",get:function get(){return this._preempt}},{key:"registerEvents",value:function registerEvents(){if(eventStream_eventStream.registerEvent(this.name+"LostDefEvent",this.lost.bind(this)),eventStream_eventStream.registerEvent(this.name+"GotDefEvent",this.got.bind(this)),void 0!==this._opps)for(var i=0;i<this._opps.length;i++)eventStream_eventStream.registerEvent(this._opps[i]+"GotDefEvent",this.lost.bind(this))}},{key:"raiseEventGot",value:function raiseEventGot(){eventStream_eventStream.raiseEvent("DefGot",this)}},{key:"raiseEventLost",value:function raiseEventLost(){eventStream_eventStream.raiseEvent("DefLost",this)}},{key:"raiseEventSet",value:function raiseEventSet(){eventStream_eventStream.raiseEvent("DefPrioritySetEvent",this)}},{key:"got",value:function got(){this.have||(this.reset_prio(),def_get(def_getPrototypeOf(Def.prototype),"got",this).call(this))}},{key:"lost",value:function lost(){this.have&&def_get(def_getPrototypeOf(Def.prototype),"lost",this).call(this)}},{key:"set_prio",value:function set_prio(prio){this._prio.setPrio(prio),this.raiseEventSet()}},{key:"set_default_prio",value:function set_default_prio(prio){this._prio.setDefault(prio),this.set_prio(prio)}},{key:"toggle_default_prio",value:function toggle_default_prio(prio){this._prio.prio===prio?this.set_default_prio(0):this.set_default_prio(prio)}},{key:"reset_prio",value:function reset_prio(){this._prio.reset(),this.raiseEventSet()}},{key:"set_command",value:function set_command(cmd){this._command=cmd}}]),Def}(trackable),DefServerside=function(_Def){def_inherits(DefServerside,_Def);var _super2=def_createSuper(DefServerside);function DefServerside(){return def_classCallCheck(this,DefServerside),_super2.apply(this,arguments)}return def_createClass(DefServerside,[{key:"isServerSide",get:function get(){return!0}}]),DefServerside}(Def),defTable={acrobatics:{command:"acrobatics on",bals_req:["balance","equilibrium"],bals_used:["balance"],blocks:["death","sleeping"],skills:["Bard"],serverside:!0},airpocket:{command:["outr calcite","eat calcite"],bals_req:[],bals_used:[],blocks:["death","sleeping","anorexia"],serverside:!0},alertness:{command:"alertness on",bals_req:["equilibrium"],bals_used:["equilibrium"],serverside:!0},aria:{command:"sing aria at me",bals_req:["voice"],bals_used:["voice"],blocks:["death","sleeping"],skills:["Bard"]},arctar:{command:"command orb",bals_req:["balance","equilibrium"],bals_used:["free"],blocks:["death","sleeping"],skills:["Occultist"]},arrowcatching:{command:"arrowcatch on",bals_req:["balance","equilibrium"],bals_used:["balance"],blocks:["death","sleeping"],skills:["Bard"],serverside:!0},astronomy:{command:"astronomy empower me",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],blocks:["death","sleeping"],skills:["Alchemist"],serverside:!0},balancing:{command:"balancing on",bals_req:["balance","equilibrium"],bals_used:["balance"],blocks:["death","sleeping"],skills:["Bard"],serverside:!0},belltattoo:{command:"touch bell",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],blocks:["prone","death","sleeping",["brokenleftarm","brokenrightarm"],["brokenleftarm","damagedrightarm"],["brokenleftarm","mangledrightarm"],["damagedleftarm","brokenrightarm"],["damagedleftarm","damagedrightarm"],["damagedleftarm","mangledrightarm"],["mangledleftarm","brokenrightarm"],["mangledleftarm","damagedrightarm"],["mangledleftarm","mangledrightarm"],"entangled","transfixation","impaled","webbed","bound","icefist"],serverside:!0},blindness:{command:["outr arsenic","eat arsenic"],bals_req:["herb"],bals_used:["herb"],blocks:["death","sleeping","anorexia"],serverside:!0},blocking:{command:"block d",bals_req:["balance","equilibrium"],bals_used:["balance"],blocks:["death","sleeping","prone"]},bodyblock:{command:"bdb",bals_req:["balance","equilibrium"],bals_used:["balance"],blocks:["death","sleeping"],skills:["Monk"],serverside:!0},boostedregeneration:{command:"boost regeneration",bals_req:["free"],bals_used:["free"],blocks:["death","sleeping"],skills:["Monk"],serverside:!0},cloak:{command:"touch cloak",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],blocks:["prone","death","sleeping",["brokenleftarm","brokenrightarm"],["brokenleftarm","damagedrightarm"],["brokenleftarm","mangledrightarm"],["damagedleftarm","brokenrightarm"],["damagedleftarm","damagedrightarm"],["damagedleftarm","mangledrightarm"],["mangledleftarm","brokenrightarm"],["mangledleftarm","damagedrightarm"],["mangledleftarm","mangledrightarm"],"entangled","transfixation","impaled","webbed","bound","icefist"],serverside:!0},chargeshield:{command:"cast chargeshield at me",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],skills:["Magi"],serverside:!0},coldresist:{command:"activate cold resistance",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,serverside:!0},compoundmask:{command:["wear mask","secure mask"],bals_req:["free"],bals_used:["free"],skills:["Alchemist"]},consciousness:{command:"consciousness on",bals_req:["free"],bals_used:["free"],blocks:["death","sleeping"],skills:["Monk","Blademaster"],serverside:!0},constitution:{command:"constitution",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],skills:["Monk","Blademaster"],serverside:!0},curseward:{command:"curseward",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],serverside:!0},deafness:{command:["outr calamine","eat calamine"],bals_req:["herb","deafness"],bals_used:["herb","deafness"],blocks:["death","sleeping","anorexia"],serverside:!0},deathsight:{command:"deathsight",bals_req:["balance","equilibrium"],bals_used:["free"],serverside:!0},density:{command:"wear shackle",bals_req:["salve"],bals_used:["salve"],blocks:["death","slickness","sleeping"],serverside:!0},devilmark:{command:"devilmark",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],blocks:["death","prone","sleeping"],skills:["Occultist"],serverside:!0},diamondskin:{command:"cast diamondskin",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],skills:["Magi"],serverside:!0},distortedaura:{command:"distortaura",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],blocks:["death","prone","sleeping"],skills:["Occultist"],serverside:!0},dragonarmour:{command:"dragonarmour",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],blocks:["death","prone","sleeping"],skills:["Dragon"],serverside:!0},dragonbreath:{command:"summon ice",bals_req:["balance","equilibrium","dragonbreath"],bals_used:["free","dragonbreath"],blocks:["death","prone","sleeping"],skills:["Dragon"],preempt:!0,serverside:!0},drunkensailor:{command:"drunkensailor",bals_req:["balance","equilibrium"],bals_used:["balance"],blocks:["death","sleeping"],skills:["Bard"],serverside:!0},electricresist:{command:"activate electric resistance",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,serverside:!0},enhancedform:{command:["amalgamate enhancement","imbibe enhancement"],bals_req:["balance","equilibrium"],bals_used:["free"],blocks:["death","sleeping"],skills:["Alchemist"]},evadeblock:{command:"evb",bals_req:["balance","equilibrium"],bals_used:["balance"],blocks:["death","sleeping"],skills:["Monk"],serverside:!0},fireresist:{command:"activate fire resistance",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,serverside:!0},fangbarrier:{command:"apply quicksilver",bals_req:["salve","sileris"],bals_used:["salve","sileris"],blocks:["death","slickness","paralysis","sleeping"],serverside:!0},fireshroud:{command:"ignite shroud",bals_req:["balance","equilibrium"],bals_used:["balance"],blocks:["death","slickness","paralysis","sleeping"],serverside:!0,skills:["Fire Elemental Lord"]},fury:{command:"fury on",bals_req:["balance"],bals_used:["equilibrium"],skills:["Runewarden"],serverside:!0},flying:{command:"fly",bals_req:["balance, equilibrium"],bals_used:["balance"],blocks:["prone","death","sleeping","entangled","transfixation","impaled","webbed","bound"],serverside:!1},ghost:{command:"conjure ghost",bals_req:["equilibrium"],bals_used:["equilibrium"],skills:["Serpent"],serverside:!0},groundwatch:{command:"groundwatch on",bals_req:["free"],bals_used:["free"],serverside:!0},"guarding right leg":{command:"guard right leg",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,skills:["Monk"],opps:["guarding left leg","guarding left arm","guarding right arm","guarding torso","guarding head","parrying right leg","parrying left leg","parrying left arm","parrying right arm","parrying torso","parrying head","parrying left","parrying right","parrying centre"]},"guarding left leg":{command:"guard left leg",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,skills:["Monk"],opps:["guarding right leg","guarding left arm","guarding right arm","guarding torso","guarding head","parrying right leg","parrying left leg","parrying left arm","parrying right arm","parrying torso","parrying head","parrying left","parrying right","parrying centre"]},"guarding right arm":{command:"guard right arm",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,skills:["Monk"],opps:["guarding left leg","guarding left arm","guarding right leg","guarding torso","guarding head","parrying right leg","parrying left leg","parrying left arm","parrying right arm","parrying torso","parrying head","parrying left","parrying right","parrying centre"]},"guarding left arm":{command:"guard left arm",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,skills:["Monk"],opps:["guarding left leg","guarding right leg","guarding right arm","guarding torso","guarding head","parrying right leg","parrying left leg","parrying left arm","parrying right arm","parrying torso","parrying head","parrying left","parrying right","parrying centre"]},"guarding head":{command:"guard head",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,skills:["Monk"],opps:["guarding left leg","guarding left arm","guarding right arm","guarding torso","guarding right leg","parrying right leg","parrying left leg","parrying left arm","parrying right arm","parrying torso","parrying head","parrying left","parrying right","parrying centre"]},"guarding torso":{command:"guard torso",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,skills:["Monk"],opps:["guarding left leg","guarding left arm","guarding right arm","guarding right leg","guarding head","parrying right leg","parrying left leg","parrying left arm","parrying right arm","parrying torso","parrying head","parrying left","parrying right","parrying centre"]},heartsfury:{command:"heartsfury",bals_req:["balance","equilibrium"],bals_used:["balance"],blocks:["death","sleeping"],skills:["Bard"],serverside:!0},heldbreath:{command:"hold breath",bals_req:["balance","equilibrium"],bals_used:["free"],blocks:["death","asthma","sleeping"],preempt:!0,serverside:!0},hiding:{command:"hide",bals_req:["equilibrium","balance"],bals_used:["balance"],skills:["Serpent"],serverside:!0},hypersight:{command:"hypersight on",bals_req:["balance"],bals_used:["equilibrium"],serverside:!0},immunity:{command:"immunity",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],blocks:["death","sleeping"],skills:["Monk","Blademaster"],serverside:!0},insomnia:{command:"insomnia",bals_req:["free"],bals_used:["free"],blocks:["death","hypersomnia","sleeping"],serverside:!0},insulation:{command:"apply caloric",bals_req:["salve"],bals_used:["salve"],blocks:["death","sleeping","slickness","hypothermia"],serverside:!0},insufflate:{command:["get phial from pack","amalgamate insufflate potency 4 stability 1","imbibe insufflate"],bals_req:["free"],bals_used:["free"],blocks:["death","sleeping"],skills:["Alchemist"],preempt:!0},ironform:{command:["get phial from pack","amalgamate petrifying potency 4 stability 1","imbibe petrifying"],bals_req:["free"],bals_used:["free"],blocks:["death","sleeping"],skills:["Alchemist"],preempt:!0},kaiboost:{command:"kai boost",bals_req:["balance","equilibrium"],bals_used:["free"],blocks:["death","sleeping"],skills:["Monk"],preempt:!0,serverside:!0},kaitrance:{command:"kai trance",bals_req:["free"],bals_used:["free"],blocks:["death","sleeping"],skills:["Monk"],serverside:!0},kola:{command:["outr quartz","eat quartz"],bals_req:["free"],bals_used:["free"],blocks:["death","sleeping","anorexia"],serverside:!0},lay:{command:"sing lay",bals_req:["voice"],bals_used:["voice"],blocks:["death","sleeping"],skills:["Bard"],serverside:!0},levitating:{command:"sip levitation",bals_req:["free"],bals_used:["free"],blocks:["death","anorexia","sleeping"],serverside:!0},lifevision:{command:"astralvision",bals_req:["equilibrium"],bals_used:["equilibrium"],skills:["Occultist"],serverside:!0},lipreading:{command:"lipread",bals_req:["equilibrium"],bals_used:["equilibrium"],skills:["Serpent"],serverside:!0},locketdeath:{command:"solicit locket for immortality",bals_req:["free"],bals_used:["free"]},magicresist:{command:"activate magic resistance",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,serverside:!0},blademastery:{command:"mastery on",bals_req:["balance","equilibrium"],bals_used:["free"],skills:["Runewarden"],preempt:!0,serverside:!0},meditate:{command:"meditate",bals_req:["balance","equilibrium"],bals_used:["free"],blocks:["death","sleeping","impatience"],preempt:!0},mercury:{command:"educe mercury",bals_req:["balance"],bals_used:["equilibrium"],blocks:["death","sleeping"],skills:["Alchemist"],serverside:!0},metawake:{command:"metawake on",bals_req:["balance","equilibrium"],bals_used:["free"],blocks:["death","sleeping","lullaby"],serverside:!0},mindcloak:{command:"mind cloak on",bals_req:["balance","equilibrium"],bals_used:["balance"],blocks:["death","sleeping"],preempt:!0,skills:["Monk"],serverside:!0},mindnet:{command:"mindnet on",bals_req:["free"],bals_used:["free"],blocks:["death","sleeping"],skills:["Monk","Blademaster"],serverside:!0},mindseye:{command:"touch mindseye",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],blocks:["death","prone","sleeping",["brokenleftarm","brokenrightarm"],["brokenleftarm","damagedrightarm"],["brokenleftarm","mangledrightarm"],["damagedleftarm","brokenrightarm"],["damagedleftarm","damagedrightarm"],["damagedleftarm","mangledrightarm"],["mangledleftarm","brokenrightarm"],["mangledleftarm","damagedrightarm"],["mangledleftarm","mangledrightarm"],"entangled","transfixation","impaled","webbed","bound","icefist"],serverside:!0},mounted:{command:"",bals_req:["balance","equilibrium"],bals_used:["free"],blocks:["death","sleeping","stunned","prone","paralysis","entangled","transfixation","impaled","webbed","bound"],preempt:!0},nightsight:{command:"nightsight",bals_req:["free"],bals_used:["free"],serverside:!0},numbness:{command:"numb",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],skills:["Monk"]},"parrying right leg":{command:"parry right leg",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,opps:["guarding left leg","guarding left arm","guarding right arm","guarding torso","guarding head","guarding right leg","parrying left leg","parrying left arm","parrying right arm","parrying torso","parrying head","parrying left","parrying right","parrying centre"]},"parrying left leg":{command:"parry left leg",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,opps:["guarding left leg","guarding left arm","guarding right arm","guarding torso","guarding head","parrying right leg","guarding right leg","parrying left arm","parrying right arm","parrying torso","parrying head","parrying left","parrying right","parrying centre"]},"parrying right arm":{command:"parry right arm",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,opps:["guarding left leg","guarding left arm","guarding right arm","guarding torso","guarding head","parrying right leg","parrying left leg","parrying left arm","guarding right leg","parrying torso","parrying head","parrying left","parrying right","parrying centre"]},"parrying left arm":{command:"parry left arm",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,opps:["guarding left leg","guarding left arm","guarding right arm","guarding torso","guarding head","parrying right leg","parrying left leg","guarding right leg","parrying right arm","parrying torso","parrying head","parrying left","parrying right","parrying centre"]},"parrying head":{command:"parry head",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,opps:["guarding left leg","guarding left arm","guarding right arm","guarding torso","guarding head","parrying right leg","parrying left leg","parrying left arm","parrying right arm","parrying torso","guarding right leg","parrying left","parrying right","parrying centre"]},"parrying torso":{command:"parry torso",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,opps:["guarding left leg","guarding left arm","guarding right arm","guarding torso","guarding head","parrying right leg","parrying left leg","parrying left arm","parrying right arm","guarding right leg","parrying head","parrying left","parrying right","parrying centre"]},"parrying left":{command:"trueparry left",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,skills:["Bard"],opps:["guarding left leg","guarding left arm","guarding right arm","guarding torso","guarding head","parrying right leg","parrying left leg","parrying left arm","parrying right arm","parrying torso","parrying head","guarding right leg","parrying right","parrying centre"]},"parrying right":{command:"trueparry right",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,skills:["Bard"],opps:["guarding left leg","guarding left arm","guarding right arm","guarding torso","guarding head","parrying right leg","parrying left leg","parrying left arm","parrying right arm","parrying torso","parrying head","parrying left","guarding right leg","parrying centre"]},"parrying centre":{command:"trueparry centre",bals_req:["balance","equilibrium"],bals_used:["free"],preempt:!0,skills:["Bard"],opps:["guarding left leg","guarding left arm","guarding right arm","guarding torso","guarding head","parrying right leg","parrying left leg","parrying left arm","parrying right arm","parrying torso","parrying head","parrying left","parrying right","guarding right leg"]},pinchblock:{command:"pnb",bals_req:["balance","equilibrium"],bals_used:["balance"],blocks:["death","sleeping"],skills:["Monk"],serverside:!0},projectiles:{command:"projectiles on",bals_req:["free"],bals_used:["free"],skills:["Monk","Blademaster"],blocks:["death","sleeping","mounted"],preempt:!0,serverside:!0},poisonresist:{command:"sip venom",bals_req:["free"],bals_used:["free"],blocks:["death","anorexia","sleeping"],serverside:!0},prismatic:{command:"strum lyre",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],blocks:["death","prone","sleeping"]},rebounding:{command:"smoke malachite",bals_req:["smoke","rebounding"],bals_used:["smoke","rebounding"],blocks:["death","asthma","sleeping"],serverside:!0},reflections:{command:"point wand235913 at me",bals_req:["balance","equilibrium"],bals_used:["free"],blocks:["death","sleeping"]},regeneration:{command:"regeneration on",bals_req:["free"],bals_used:["free"],skills:["Monk"],blocks:["death","sleeping"],serverside:!0},resistance:{command:"resistance",bals_req:["free"],bals_used:["free"],skills:["Runewarden","Monk"],blocks:["death","sleeping"],serverside:!0},scales:{command:"scales",bals_req:["balance","equilibrium"],bals_used:["balance"],skills:["Serpent"],serverside:!0},secondsight:{command:"secondsight",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],skills:["Serpent"],serverside:!0},selfishness:{command:"selfishness",bals_req:["balance","equilibrium"],bals_used:["balance"],serverside:!0},shield:{command:"touch shield",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],blocks:["death","prone","sleeping",["brokenleftarm","brokenrightarm"],["brokenleftarm","damagedrightarm"],["brokenleftarm","mangledrightarm"],["damagedleftarm","brokenrightarm"],["damagedleftarm","damagedrightarm"],["damagedleftarm","mangledrightarm"],["mangledleftarm","brokenrightarm"],["mangledleftarm","damagedrightarm"],["mangledleftarm","mangledrightarm"],"entangled","transfixation","impaled","webbed","bound","icefist"],serverside:!0},shintrance:{command:"shin trance",bals_req:["free"],bals_used:["free"],skills:["Blademaster"],blocks:["death","sleeping"],serverside:!0},shinclarity:{command:"clarity",bals_req:["balance"],bals_used:["equilibrium"],skills:["Blademaster"],blocks:["death","sleeping"],serverside:!0},shinbinding:{command:"shinbinding on",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],skills:["Blademaster"],blocks:["death","sleeping"],serverside:!0},shroud:{command:"shroud",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],skills:["Occultist"],serverside:!0},softfocusing:{command:"softfocus on",bals_req:["free"],bals_used:["free"],blocks:["death","sleeping"],serverside:!0},songbird:{command:"whistle for songbird",bals_req:["equilibrium"],bals_used:["equilibrium"],blocks:["death","sleeping"],skills:["Bard"]},speed:{command:"sip speed",bals_req:["speed"],bals_used:["speed"],blocks:["death","anorexia","sleeping"],serverside:!0},skysight:{command:"manifest skysight",bals_req:["balance","equilibrium"],bals_used:["balance"],blocks:["death","sleeping","stunned","prone","paralysis","entangled","transfixation","impaled","webbed","bound"],skills:["Air Elemental Lord"],serverside:!0},skywatch:{command:"skywatch on",bals_req:["free"],bals_used:["free"],serverside:!0},stonefist:{command:"cast stonefist",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],skills:["Magi"],serverside:!0},stoneskin:{command:"cast stoneskin",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],skills:["Magi"],serverside:!0},sulphur:{command:"educe sulphur",bals_req:["balance"],bals_used:["equilibrium"],blocks:["death","sleeping"],skills:["Alchemist"],serverside:!0},tekurastance:{command:"tekurastance",bals_req:["free"],bals_used:["balance"],skills:["Monk"]},telesense:{command:"telesense on",bals_req:["free"],bals_used:["free"],serverside:!0},temperance:{command:"sip frost",bals_req:["free"],bals_used:["free"],blocks:["death","anorexia","sleeping"],serverside:!0},tempest:{command:"manifest tempest",bals_req:["balance","equilibrium"],bals_used:["balance"],blocks:["death","sleeping","stunned","prone","paralysis","entangled","transfixation","impaled","webbed","bound"],skills:["Air Elemental Lord"],serverside:!0},thirdeye:{command:"thirdeye",bals_req:["free"],bals_used:["free"],serverside:!0},tin:{command:"educe tin",bals_req:["balance"],bals_used:["equilibrium"],blocks:["death","sleeping","prone"],skills:["Alchemist"],serverside:!0},tentacles:{command:"tentacles",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],blocks:["death","sleeping","prone"],skills:["Occultist"],serverside:!0},toughness:{command:"toughness",bals_req:["free"],bals_used:["free"],skills:["Monk","Blademaster"],serverside:!0},treewatch:{command:"treewatch on",bals_req:["free"],bals_used:["free"],serverside:!0},tune:{command:"sing tune",bals_req:["voice"],bals_used:["voice"],blocks:["death","sleeping"],skills:["Bard"],serverside:!0},twoartsstance:{command:"",bals_req:["free"],bals_used:["free"],blocks:["death","sleeping"],skills:["Blademaster"]},vigilance:{command:"vigilance on",bals_req:["free"],bals_used:["free"],serverside:!0},vitality:{command:"vitality on",bals_req:["balance","equilibrium"],bals_used:["equilibrium"],skills:["Monk"],serverside:!0},weathering:{command:"weathering on",bals_req:["free"],bals_used:["free"],skills:["Runewarden","Monk","Blademaster"],blocks:["death","sleeping"],serverside:!0},weaving:{command:"weaving on",bals_req:["balance","equilibrium"],bals_used:["balance"],skills:["Serpent"],serverside:!0}},defTable_defPrios={keepup:{alertness:0,curseward:0,deathsight:0,density:0,groundwatch:0,heldbreath:0,hypersight:0,lifevision:0,metawake:0,mindseye:0,reflections:0,shield:0,softfocusing:0,telesense:0,treewatch:0,vigilance:0,insomnia:0,speed:0,insulation:0,kola:0,deafness:0,blindness:0,temperance:0,cloak:0,airpocket:0,coldresist:0,electricresist:0,fangbarrier:0,fireresist:0,levitating:0,magicresist:0,nightsight:0,poisonresist:0,rebounding:0,skywatch:0,thirdeye:0,astronomy:0,mercury:0,sulphur:0,tin:0,enhancedform:0,ironform:0,acrobatics:0,aria:0,arrowcatching:0,balancing:0,drunkensailor:0,heartsfury:0,lay:0,songbird:0,tune:0,shintrance:0,shinbinding:0,shinclarity:0,dragonarmour:0,dragonbreath:0,chargeshield:0,diamondskin:0,stonefist:0,stoneskin:0,bodyblock:0,constitution:0,evadeblock:0,immunity:0,kaiboost:0,numbness:0,pinchblock:0,vitality:0,kaitrance:0,regeneration:0,boostedregeneration:0,consciousness:0,mindcloak:0,mindnet:0,projectiles:0,resistance:0,toughness:0,weathering:0,arctar:0,devilmark:0,distortedaura:0,tentacles:0,fury:0,blademastery:0,ghost:0,hiding:0,lipreading:0,scales:0,secondsight:0,shroud:0,weaving:0,blocking:0,locketdeath:0,meditate:0,mounted:0,prismatic:0,"parrying left leg":0,"parrying right arm":0,"parrying left arm":0,"parrying head":0,"parrying torso":0,"parrying left":0,"parrying right":0,"parrying centre":0,"parrying right leg":0,compoundmask:0,twoartsstance:0,tekurastance:0,"guarding left leg":0,"guarding right arm":0,"guarding left arm":0,"guarding head":0,"guarding torso":0,"guarding right leg":0},static:{mindseye:0,lifevision:0,alertness:0,curseward:0,deathsight:0,dragonarmour:0,astronomy:0,ironform:0,mercury:0,sulphur:0,tin:0,shinbinding:0,shinclarity:0,chargeshield:0,diamondskin:0,stonefist:0,stoneskin:0,constitution:0,bodyblock:0,devilmark:0,distortedaura:0,ghost:0,lipreading:0,scales:0,secondsight:0,weaving:0,shroud:0}},limbs={short:{rl:"right leg",ll:"left leg",ra:"right arm",la:"left arm",h:"head",tt:"torso",c:"centre",l:"left",r:"right"},long:{"right leg":"rl","left leg":"ll","right arm":"ra","left arm":"la",head:"h",torso:"tt",centre:"c",left:"l",right:"r"}};function sendCmd(cmd){cmd&&window.nexusclient.send_commands(cmd),eventStream_eventStream.raiseEvent("SendCommandEvent",cmd)}function psend(what){sys_sys.isPaused()||sendCmd(what)}function sendInline(cmd){Array.isArray(cmd)&&sendCmd(cmd.join(sys_sys.settings.sep)),eventStream_eventStream.raiseEvent("SendCommandEvent",cmd)}var serversideSettings={loaded:!1,status:{},affs:{},defs:{}};var Defs={},defs_defs=defTable;for(var def in defs_defs){var curDef=defs_defs[def],defs_prio=void 0===defTable_defPrios.keepup[def]?0:defTable_defPrios.keepup[def],defs_obj={};defs_obj.command=curDef.command,defs_obj.bals_req=curDef.bals_req,defs_obj.bals_used=curDef.bals_used,defs_obj.blocks=curDef.blocks,defs_obj.skills=curDef.skills,defs_obj.preempt=curDef.preempt,defs_obj.opps=curDef.opps,defs_obj.serverside=curDef.serverside,defs_obj.serverside?Defs[def]=new DefServerside(def,defs_prio,defs_obj):Defs[def]=new Def(def,defs_prio,defs_obj)}function getMissingDefs(){var defs=Defs;return Object.keys(defs).filter((function(def){return!defs[def].isServerSide&&!defs[def].have&&!defs[def].isIgnored})).sort((function(a,b){return defs[a].prio-defs[b].prio}))}function getDefOutputs(affList,balList){for(var defOutputs=[],missingDefs=getMissingDefs(),remainingDefs=[],i=0;i<missingDefs.length;i++){var _def2=Defs[missingDefs[i]],canPerform=!0;if(void 0!==_def2.blocks&&0!==_def2.blocks.length&&Array.arraysIntersect(_def2.blocks,affList))canPerform=!1;else if(0!==_def2.balsUsed.length&&"free"===_def2.balsUsed[0])for(var j=0;j<_def2.balsReq.length&&canPerform;j++)-1===balList.indexOf(_def2.balsReq[j])&&(canPerform=!1);else remainingDefs.push(_def2),canPerform=!1;canPerform&&(defOutputs=defOutputs.concat(_def2.command))}for(var _i=0;_i<remainingDefs.length;_i++){var _def3=remainingDefs[_i],_canPerform=!0;if(0!==_def3.balsReq.length&&"free"!==_def3.balsReq[0])for(var _j=0;_j<_def3.balsReq.length&&_canPerform;_j++)-1===balList.indexOf(_def3.balsReq[_j])&&(_canPerform=!1);if(_canPerform){defOutputs=defOutputs.concat(_def3.command);for(var _j2=0;_j2<_def3.balsUsed.length;_j2++)balList.splice(balList.indexOf(_def3.balsUsed[_j2]),1)}}return defOutputs}function repop(args){if(serversideSettings.loaded){var _defs=Defs,keepupPrios=defTable_defPrios.keepup;for(var _def6 in _defs){var cur_def=_defs[_def6];(sys_sys.isClass(cur_def.skills)||void 0===cur_def.skills||0===cur_def.skills.length)&&keepupPrios[_def6]?cur_def.set_default_prio(keepupPrios[_def6]):cur_def.set_default_prio(0)}for(var limb in limbs.long)Defs["parrying "+limb].isIgnored||parry(limb),Defs["guarding "+limb]&&(Defs["guarding "+limb].isIgnored||parry(limb));eventStream_eventStream.raiseEvent("ForcePopulateEvent")}}function parry(arg){for(var _limb in limbs.long)Defs["parrying "+_limb].set_default_prio(0),Defs["guarding "+_limb]&&Defs["guarding "+_limb].set_default_prio(0);var limb=limbs.short[arg]||arg;sys_sys.isClass(Defs["guarding "+limb].skills)?Defs["guarding "+limb].set_default_prio(25):(Defs["parrying "+limb].set_default_prio(25),sys_sys.isClass("Dragon")?Defs["parrying "+limb].set_command("clawparry "+limb):Defs["parrying "+limb].set_command("parry "+limb))}eventStream_eventStream.registerEvent("ClassChanged",repop),eventStream_eventStream.registerEvent("ServersideSettingsCaptured",repop);var Caches={},cache=cacheTable;for(var herb in cache){var amount=cache[herb],caches_obj={blocks:["death","sleeping",["brokenleftarm","brokenrightarm"],["brokenleftarm","damagedrightarm"],["brokenleftarm","mangledrightarm"],["damagedleftarm","brokenrightarm"],["damagedleftarm","damagedrightarm"],["damagedleftarm","mangledrightarm"],["mangledleftarm","brokenrightarm"],["mangledleftarm","damagedrightarm"],["mangledleftarm","mangledrightarm"],"entangled","transfixation","impaled","webbed","bound","blackout"]};Caches[herb]=new Cache(herb,amount,caches_obj)}function getMissingCache(){var caches=Caches,current_cache=[];for(var _cache in caches)caches[_cache].needToOutr&&current_cache.push(caches[_cache]);return current_cache}function getCacheOutputs(affList){if(Affs.blindness.have||Defs.mindseye.have){for(var missingCache=getMissingCache(),cacheOutputs=[],i=0;i<missingCache.length;i++){var _cache2=missingCache[i];Array.arraysIntersect(_cache2.blocks,affList)||(cacheOutputs=cacheOutputs.concat(_cache2.command))}return cacheOutputs}return[]}var filterHerbAndAmount=function filterHerbAndAmount(herb){if("inv"===herb.location&&void 0!==herb.item&&"curative"===herb.item.icon){var herbShort="",_amount=1;if(herb.item.name.startsWith("a group of")){var matches=herb.item.name.match(/(\d+)\s+(.+)/i);herbShort=herb_name_to_herb[matches[2]],_amount=parseInt(matches[1])}else herbShort=herb_name_to_herb[herb.item.name],_amount=1;if(void 0!==herbShort)return{name:herbShort,amount:_amount}}return!1};eventStream_eventStream.registerEvent("Char.Items.Add",(function eventGmcpInvAdd(herb){var herbAmt=filterHerbAndAmount(herb);herbAmt&&eventStream_eventStream.raiseEvent(herbAmt.name+"CacheCountAddEvent",herbAmt.amount)}));eventStream_eventStream.registerEvent("Char.Items.Remove",(function eventGmcpInvRemove(herb){var herbAmt=filterHerbAndAmount(herb);herbAmt&&eventStream_eventStream.raiseEvent(herbAmt.name+"CacheCountSubtractEvent",herbAmt.amount)}));eventStream_eventStream.registerEvent("IRE.Rift.Change",(function eventGmcpIreRiftChange(args){var herb=args.name,amount=parseInt(args.amount);eventStream_eventStream.raiseEvent(herb+"RiftSetEvent",amount)}));eventStream_eventStream.registerEvent("IRE.Rift.List",(function eventGmcpIreRiftList(args){for(var i=0;i<args.length;i++)eventStream_eventStream.raiseEvent(args[i].name+"RiftSetEvent",args[i].amount);eventStream_eventStream.raiseEvent("RiftListCompleteEvent")}));var cures={ferrum:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat ferrum",order:["darkshade","haemophilia","lethargy","addiction","scytherus","nausea","flushings"],prio:0},magnesium:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat magnesium",order:["paralysis","slickness","pyramides"],prio:0},aurum:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat aurum",order:["clumsiness","healthleech","sensitivity","weariness","asthma","hypochondria","rebbies","parasite"],prio:0},calamine:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat calamine",order:["deafness"],delay:2.5,prio:0},argentum:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat argentum",order:["masochism","loneliness","vertigo","recklessness","agoraphobia","guilt","whisperingmadness"],prio:0},cuprum:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat cuprum",order:["pacified","peace","lovers","generosity","indifference","retribution"],prio:0},antimony:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat antimony",order:["temperedcholeric","temperedmelancholic","temperedphlegmatic","temperedsanguine"],prio:0},arsenic:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat arsenic",prio:0},stannum:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat stannum",order:["claustrophobia","paranoia","confusion","hypersomnia","hallucinations","dementia"],prio:0},plumbum:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],order:["stupidity","epilepsy","dizziness","shyness","impatience","dissonance","depression","sandfever","mycalium","shadowmadness"],command:"eat plumbum",prio:0},ginseng:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat ginseng",order:["darkshade","haemophilia","lethargy","addiction","scytherus","nausea","flushings"],prio:0},bloodroot:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat bloodroot",order:["paralysis","slickness","pyramides"],prio:0},kelp:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat kelp",order:["clumsiness","healthleech","sensitivity","weariness","asthma","hypochondria","rebbies","parasite"],prio:0},hawthorn:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat hawthorn",order:["deafness"],delay:2.5,prio:0},lobelia:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat lobelia",order:["masochism","loneliness","vertigo","recklessness","agoraphobia","guilt","whisperingmadness"],prio:0},bellwort:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat bellwort",order:["pacified","peace","lovers","generosity","indifference","retribution"],prio:0},ginger:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat ginger",order:["temperedcholeric","temperedmelancholic","temperedphlegmatic","temperedsanguine"],prio:0},bayberry:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat bayberry",prio:0},ash:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat ash",order:["claustrophobia","paranoia","confusion","hypersomnia","hallucinations","dementia"],prio:0},goldenseal:{bals_used:["herb"],bals_req:["herb"],blocks:["death","anorexia","sleeping"],command:"eat goldenseal",order:["stupidity","epilepsy","dizziness","shyness","impatience","dissonance","depression","sandfever","mycalium","shadowmadness"],prio:0},smoke:{bals_used:["smoke"],bals_req:["smoke"],blocks:["death","asthma","sleeping"],command:"smoke cinnabar",order:["aeon","disloyalty","hellsight","manaleech","slickness","deadening"],prio:0},cinnabar:{bals_used:["smoke"],bals_req:["smoke"],blocks:["death","asthma","sleeping"],command:"smoke cinnabar",order:["aeon","deadening"],prio:0},malachite:{bals_used:["smoke"],bals_req:["smoke"],blocks:["death","asthma","sleeping"],command:"smoke malachite",prio:0},realgar:{bals_used:["smoke"],bals_req:["smoke"],blocks:["death","asthma","sleeping"],command:"smoke realgar",order:["disloyalty","hellsight","manaleech","slickness"],prio:0},elm:{bals_used:["smoke"],bals_req:["smoke"],blocks:["death","asthma","sleeping"],command:"smoke elm",order:["aeon","deadening"],prio:0},skullcap:{bals_used:["smoke"],bals_req:["smoke"],blocks:["death","asthma","sleeping"],command:"smoke skullcap",prio:0},valerian:{bals_used:["smoke"],bals_req:["smoke"],blocks:["death","asthma","sleeping"],command:"smoke valerian",order:["disloyalty","hellsight","manaleech","slickness"],prio:0},caloric:{bals_used:["salve"],bals_req:["salve"],blocks:["death","slickness","sleeping"],command:"apply caloric",order:["frozen","shivering"],prio:0},"epidermal to body":{bals_used:["salve"],bals_req:["salve"],blocks:["death","slickness","sleeping"],command:"apply epidermal to body",order:["anorexia"],prio:0},"epidermal to head":{bals_used:["salve"],bals_req:["salve"],blocks:["death","slickness","sleeping"],command:"apply epidermal to head",order:["blindness","scalded","deafness"],prio:0},"epidermal to ears":{bals_used:["salve"],bals_req:["salve"],blocks:["death","slickness","sleeping"],command:"apply epidermal to ears",order:["deafness"],prio:0},"mending to head":{bals_used:["salve"],bals_req:["salve"],blocks:["death","slickness","sleeping"],command:"apply mending to head",order:["crushedthroat","dazzled"],prio:0},"mending to arms":{bals_used:["salve"],bals_req:["salve"],blocks:["death","slickness","sleeping"],command:"apply mending to arms",order:["brokenleftarm","brokenrightarm"],prio:0},"mending to legs":{bals_used:["salve"],bals_req:["salve"],blocks:["death","slickness","sleeping"],command:"apply mending to legs",order:["brokenleftleg","brokenrightleg"],prio:0},"mending to torso":{bals_used:["salve"],bals_req:["salve"],blocks:["death","slickness","sleeping"],command:"apply mending to torso",order:["burning"],prio:0},"restoration to head":{bals_used:["salve"],bals_req:["salve"],blocks:["death","slickness","sleeping"],command:"apply restoration to head",order:["mangledhead","damagedhead","calcifiedskull","concussion"],delay:4,prio:0},"restoration to torso":{bals_used:["salve"],bals_req:["salve"],blocks:["death","slickness","sleeping"],command:"apply restoration to torso",order:["hypothermia","heartseed","serioustrauma","mildtrauma","calcifiedtorso"],delay:4,prio:0},"restoration to arms":{bals_used:["salve"],bals_req:["salve"],blocks:["death","slickness","sleeping"],command:"apply restoration to arms",order:["mangledleftarm","mangledrightarm","damagedleftarm","damagedrightarm"],delay:4,prio:0},"restoration to legs":{bals_used:["salve"],bals_req:["salve"],blocks:["death","slickness","sleeping"],command:"apply restoration to legs",order:["mangledleftleg","mangledrightleg","damagedleftleg","damagedrightleg"],delay:4,prio:0},insomnia:{bals_req:["free"],bals_used:["free"],blocks:["death","hypersomnia","sleeping"],command:"insomnia",order:["insomnia"],prio:0},focus:{bals_req:["focus"],bals_used:["focus"],blocks:["death","impatience","sleeping"],command:"focus",order:["stupidity","epilepsy","agoraphobia","masochism","claustrophobia","recklessness","dizziness","confusion","loneliness","vertigo","shyness","lovers","anorexia","generosity","pacified","stuttering"],prio:0},"health to head":{bals_req:["sip"],bals_used:["sip"],command:"apply health to head",order:["skullfractures"],prio:0},"health to torso":{bals_req:["sip"],bals_used:["sip"],command:"apply health to torso",order:["crackedribs","grievouswounds"],prio:0},"health to arms":{bals_req:["sip"],bals_used:["sip"],command:"apply health to arms",order:["wristfractures"],prio:0},"health to legs":{bals_req:["sip"],bals_used:["sip"],command:"apply health to legs",order:["torntendons"],prio:0},concentrate:{blocks:["death","sleeping","confusion"],command:"concentrate",order:["disrupted"],prio:0},immunity:{bals_req:["immunity"],bals_used:["immunity"],blocks:["death","sleeping","anorexia"],command:"sip immunity",order:["voyria"],prio:0},stand:{bals_req:["balance","equilibrium"],blocks:["death","sleeping","paralysis","brokenrightleg","brokenleftleg","damagedleftleg","damagedrightleg","mangledrightleg","mangledleftleg","entangled","transfixation","impaled","webbed","bound"],command:"stand",order:["prone"],prio:0},tree:{bals_used:["tree"],bals_req:["tree"],blocks:["death","sleeping","paralysis",["brokenleftarm","brokenrightarm"],["brokenleftarm","damagedrightarm"],["brokenleftarm","mangledrightarm"],["damagedleftarm","brokenrightarm"],["damagedleftarm","damagedrightarm"],["damagedleftarm","mangledrightarm"],["mangledleftarm","brokenrightarm"],["mangledleftarm","damagedrightarm"],["mangledleftarm","mangledrightarm"],"entangled","transfixation","impaled","webbed","bound"],command:"touch tree",order:["clumsiness","healthleech","sensitivity","darkshade","haemophilia","lethargy","addiction","scytherus","nausea","peace","stupidity","epilepsy","agoraphobia","masochism","claustrophobia","recklessness","dizziness","shyness","paranoia","confusion","loneliness","vertigo","hypersomnia","hallucinations","justice","lovers","dementia","weariness","anorexia","impatience","asthma","voyria","selarnia","frozen","shivering","brokenleftleg","brokenrightleg","brokenleftarm","brokenrightarm","aeon","generosity","pacified","stuttering","blackout","burning","skullfractures","torntendons","crackedribs","wristfractures","deadening","dazed","disloyalty","dissonance","hellsight","hypochondria","itching","manaleech","slashedthroat","slickness","stuttering","temperedcholeric","temperedmelancholic","temperedphlegmatic","temperedsanguine"],prio:0},health:{bals_req:["sip"],bals_used:["sip"],blocks:["death","sleeping","anorexia"],command:"sip health",prio:0},mana:{bals_req:["sip"],bals_used:["sip"],blocks:["death","sleeping","anorexia"],command:"sip mana",prio:0},potash:{bals_req:["moss"],bals_used:["moss"],blocks:["death","sleeping","anorexia"],command:"eat potash",prio:0},moss:{bals_req:["moss"],bals_used:["moss"],blocks:["death","sleeping","anorexia"],command:"eat moss",prio:0},fitness:{bals_req:["equilibrium","balance","fitness"],bals_used:["balance","fitness"],blocks:["death","weariness","sleeping"],skills:["Monk","Runewarden"],command:"fitness",order:["asthma"],prio:0},bloodboil:{bals_req:["equilibrium","balance","bloodboil"],bals_used:["equilibrium","bloodboil"],blocks:["death","haemophilia","sleeping",["brokenleftarm","brokenrightarm"],["brokenleftarm","damagedrightarm"],["brokenleftarm","mangledrightarm"],["damagedleftarm","brokenrightarm"],["damagedleftarm","damagedrightarm"],["damagedleftarm","mangledrightarm"],["mangledleftarm","brokenrightarm"],["mangledleftarm","damagedrightarm"],["mangledleftarm","mangledrightarm"],"entangled","transfixation","impaled","webbed","bound"],skills:["Magi"],command:"cast bloodboil",order:["clumsiness","healthleech","sensitivity","darkshade","paralysis","lethargy","addiction","scytherus","nausea","peace","stupidity","epilepsy","agoraphobia","masochism","claustrophobia","recklessness","dizziness","shyness","paranoia","confusion","loneliness","vertigo","hypersomnia","hallucinations","justice","lovers","dementia","weariness","anorexia","impatience","asthma","voyria","selarnia","frozen","shivering","brokenleftleg","brokenrightleg","brokenleftarm","brokenrightarm","aeon","generosity","pacified","stuttering","blackout","burning","skullfractures","torntendons","crackedribs","wristfractures","deadening","dazed","disloyalty","dissonance","hellsight","hypochondria","itching","manaleech","slashedthroat","slickness","stuttering","temperedcholeric","temperedmelancholic","temperedphlegmatic","temperedsanguine"],prio:0},restore:{bals_req:["balance","equilibrium"],bals_used:["equilibrium"],command:"restore",order:["brokenleftarm","brokenrightarm","brokenleftleg","brokenrightleg","skullfractures","torntendons","wristfractures","crackedribs"],prio:0},dragonflex:{bals_req:["balance"],bals_used:["balance"],command:"dragonflex",skills:["Dragon"],order:["webbed","entangled"],prio:0},dragonheal:{bals_req:["balance","equilibrium"],bals_used:["equilibrium"],command:"dragonheal",skills:["Dragon"],blocks:["death","sleeping",["recklessness","weariness"]],order:["clumsiness","healthleech","sensitivity","darkshade","paralysis","haemophilia","lethargy","addiction","scytherus","nausea","peace","stupidity","epilepsy","agoraphobia","masochism","claustrophobia","recklessness","dizziness","shyness","paranoia","confusion","loneliness","vertigo","hypersomnia","hallucinations","justice","lovers","dementia","weariness","anorexia","impatience","asthma","voyria","selarnia","frozen","shivering","brokenleftleg","brokenrightleg","brokenleftarm","brokenrightarm","aeon","generosity","pacified","stuttering","blackout","burning","skullfractures","torntendons","crackedribs","wristfractures","deadening","dazed","disloyalty","dissonance","hellsight","hypochondria","itching","manaleech","slashedthroat","slickness","stuttering","temperedcholeric","temperedmelancholic","temperedphlegmatic","temperedsanguine"],prio:0},dwinnu:{bals_req:["voice"],bals_used:["voice"],command:"chant dwinnu",skills:["Bard"],order:["webbed","entangled"],prio:0},rage:{bals_req:["rage"],bals_used:["rage"],command:"rage",skills:["Runewarden"],order:["pacified","peace","lovers","generosity"],prio:95},"touch soul":{command:"touch soul",blocks:["death"],order:["amnesia"],prio:101},salt:{bals_req:["equilibrium","salt"],bals_used:["salt","equilibrium"],blocks:["death","stupidity","sleeping"],skills:["Alchemist"],command:"educe salt",order:["clumsiness","healthleech","sensitivity","darkshade","haemophilia","lethargy","addiction","scytherus","nausea","peace","paralysis","epilepsy","agoraphobia","masochism","claustrophobia","recklessness","dizziness","shyness","paranoia","confusion","loneliness","vertigo","hypersomnia","hallucinations","justice","lovers","dementia","weariness","anorexia","impatience","asthma","voyria","selarnia","frozen","shivering","brokenleftleg","brokenrightleg","brokenleftarm","brokenrightarm","aeon","generosity","pacified","stuttering","blackout","burning","skullfractures","torntendons","crackedribs","wristfractures","deadening","dazed","disloyalty","dissonance","hellsight","hypochondria","itching","manaleech","slashedthroat","slickness","stuttering","temperedcholeric","temperedmelancholic","temperedphlegmatic","temperedsanguine"],prio:0},siphon:{bals_req:["angel"],bals_used:["angel"],blocks:["death","sleeping"],skills:["Apostate","Priest"],command:"educe salt",order:["clumsiness","healthleech","sensitivity","darkshade","haemophilia","lethargy","addiction","scytherus","nausea","peace","paralysis","epilepsy","agoraphobia","masochism","claustrophobia","recklessness","dizziness","shyness","paranoia","confusion","loneliness","vertigo","hypersomnia","hallucinations","justice","lovers","dementia","weariness","anorexia","impatience","asthma","voyria","selarnia","frozen","shivering","brokenleftleg","brokenrightleg","brokenleftarm","brokenrightarm","aeon","generosity","pacified","stuttering","blackout","burning","skullfractures","torntendons","crackedribs","wristfractures","deadening","dazed","disloyalty","dissonance","hellsight","hypochondria","itching","manaleech","slashedthroat","slickness","stuttering","temperedcholeric","temperedmelancholic","temperedphlegmatic","temperedsanguine"],prio:0},shrugging:{bals_req:["equilibrium","balance","shrugging"],bals_used:["shrugging"],blocks:["death","weariness","sleeping"],skills:["Serpent"],command:"shrugging",order:["clumsiness","healthleech","sensitivity","darkshade","haemophilia","lethargy","addiction","scytherus","nausea","peace","stupidity","epilepsy","agoraphobia","masochism","claustrophobia","recklessness","dizziness","shyness","paranoia","confusion","loneliness","vertigo","hypersomnia","hallucinations","justice","lovers","dementia","paralysis","anorexia","impatience","asthma","voyria","selarnia","frozen","shivering","brokenleftleg","brokenrightleg","brokenleftarm","brokenrightarm","aeon","generosity","pacified","stuttering","blackout","burning","skullfractures","torntendons","crackedribs","wristfractures","deadening","dazed","disloyalty","dissonance","hellsight","hypochondria","itching","manaleech","slashedthroat","slickness","stuttering","temperedcholeric","temperedmelancholic","temperedphlegmatic","temperedsanguine"],prio:0},slough:{bals_req:["equilibrium","balance","slough"],bals_used:["slough","balance"],blocks:["death","weariness","sleeping"],skills:["Fire Elemental Lord"],command:"slough impurities",order:["clumsiness","healthleech","sensitivity","darkshade","haemophilia","lethargy","addiction","scytherus","nausea","peace","stupidity","epilepsy","agoraphobia","masochism","claustrophobia","recklessness","dizziness","shyness","paranoia","confusion","loneliness","vertigo","hypersomnia","hallucinations","justice","lovers","dementia","paralysis","anorexia","impatience","asthma","voyria","selarnia","frozen","shivering","brokenleftleg","brokenrightleg","brokenleftarm","brokenrightarm","aeon","generosity","pacified","stuttering","blackout","skullfractures","torntendons","crackedribs","wristfractures","deadening","dazed","disloyalty","dissonance","hellsight","hypochondria","itching","manaleech","slashedthroat","slickness","stuttering","temperedcholeric","temperedmelancholic","temperedphlegmatic","temperedsanguine"],prio:0},fool:{bals_req:["equilibrium","balance","fool"],bals_used:["fool","balance"],blocks:["death","prone","paralysis","sleeping",["brokenleftarm","brokenrightarm"],["brokenleftarm","damagedrightarm"],["brokenleftarm","mangledrightarm"],["damagedleftarm","brokenrightarm"],["damagedleftarm","damagedrightarm"],["damagedleftarm","mangledrightarm"],["mangledleftarm","brokenrightarm"],["mangledleftarm","damagedrightarm"],["mangledleftarm","mangledrightarm"],"entangled","transfixation","impaled","webbed","bound"],skills:["Occultist"],command:"fling fool at me",order:["clumsiness","healthleech","sensitivity","darkshade","haemophilia","lethargy","addiction","scytherus","nausea","peace","stupidity","epilepsy","agoraphobia","masochism","claustrophobia","recklessness","dizziness","shyness","paranoia","confusion","loneliness","vertigo","hypersomnia","hallucinations","justice","lovers","dementia","weariness","anorexia","impatience","asthma","voyria","selarnia","frozen","shivering","brokenleftleg","brokenrightleg","brokenleftarm","brokenrightarm","aeon","generosity","pacified","stuttering","blackout","burning","skullfractures","torntendons","crackedribs","wristfractures","deadening","dazed","disloyalty","dissonance","hellsight","hypochondria","itching","manaleech","slashedthroat","slickness","stuttering","temperedcholeric","temperedmelancholic","temperedphlegmatic","temperedsanguine"],prio:0},alleviate:{bals_req:["equilibrium","balance","alleviate"],bals_used:["alleviate","balance"],blocks:["death","paralysis","sleeping"],skills:["Blademaster"],command:"alleviate",order:["clumsiness","healthleech","sensitivity","darkshade","haemophilia","lethargy","addiction","scytherus","nausea","peace","stupidity","epilepsy","agoraphobia","masochism","claustrophobia","recklessness","dizziness","shyness","paranoia","confusion","loneliness","vertigo","hypersomnia","hallucinations","justice","lovers","dementia","weariness","anorexia","impatience","asthma","voyria","selarnia","frozen","shivering","brokenleftleg","brokenrightleg","brokenleftarm","brokenrightarm","aeon","generosity","pacified","stuttering","blackout","burning","skullfractures","torntendons","crackedribs","wristfractures","deadening","dazed","disloyalty","dissonance","hellsight","hypochondria","itching","manaleech","slashedthroat","slickness","stuttering","temperedcholeric","temperedmelancholic","temperedphlegmatic","temperedsanguine"],prio:0}};function cure_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function cure_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Cure=function(){function Cure(name){var prio=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,obj=arguments.length>2?arguments[2]:void 0;cure_classCallCheck(this,Cure),this._name=name,this._bals_req=obj.bals_req||[],this._bals_used=obj.bals_used||[],this._blocks=obj.blocks||[],this._command=obj.command||"",this._time_used=0,this._order=obj.order||[],this._prio=new priority(this._name,prio),this.registerEvents()}return function cure_createClass(Constructor,protoProps,staticProps){return protoProps&&cure_defineProperties(Constructor.prototype,protoProps),staticProps&&cure_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Cure,[{key:"registerEvents",value:function registerEvents(){eventStream_eventStream.registerEvent(this.name+"UsedCureEvent",this.used.bind(this))}},{key:"raiseEventCureUsed",value:function raiseEventCureUsed(){eventStream_eventStream.raiseEvent("CureUsed",this)}},{key:"raiseEventSet",value:function raiseEventSet(){eventStream_eventStream.raiseEvent("CurePrioritySetEvent",this)}},{key:"name",get:function get(){return this._name}},{key:"balsUsed",get:function get(){return this._bals_used}},{key:"balsReq",get:function get(){return this._bals_req}},{key:"blocks",get:function get(){return this._blocks}},{key:"command",get:function get(){return this._command}},{key:"order",get:function get(){return this._order}},{key:"lastUsed",get:function get(){return this._time_used}},{key:"isIgnored",get:function get(){return 0===this._prio.prio}},{key:"used",value:function used(){this._time_used=performance.now(),this.raiseEventCureUsed()}},{key:"set_prio",value:function set_prio(prio){this._prio.setPrio(prio),this.raiseEventSet()}},{key:"set_default_prio",value:function set_default_prio(prio){this._prio.setDefault(prio),this.set_prio(prio)}},{key:"toggle_default_prio",value:function toggle_default_prio(prio){this._prio.prio===prio?this.set_default_prio(0):this.set_default_prio(prio)}},{key:"reset_prio",value:function reset_prio(){this._prio.reset(),this.raiseEventSet()}}]),Cure}(),cure=Cure,Cures={};for(var cures_cure in cures){var cures_prio=cures[cures_cure].prio,cures_obj={};cures_obj.bals_used=cures[cures_cure].bals_used,cures_obj.bals_req=cures[cures_cure].bals_req,cures_obj.blocks=cures[cures_cure].blocks,cures_obj.command=cures[cures_cure].command,cures_obj.order=cures[cures_cure].order,Cures[cures_cure]=new cure(cures_cure,cures_prio,cures_obj)}eventStream_eventStream.raiseEvent("CuresCreatedEvent",Cures);var whiteList=[],rejectList=[];eventStream_eventStream.registerEvent("LustLostEvent",(function lustLost(who){rejectList.splice(rejectList.indexOf(who),1)}));function getLustCommands(){for(var cmd=[],i=0;i<rejectList.length;i++)cmd.push("reject "+rejectList[i]);return cmd}eventStream_eventStream.registerEvent("LustGotEvent",(function lustGot(who){-1===rejectList.indexOf(who)&&-1===whiteList.indexOf(who)&&(rejectList.push(who),eventStream_eventStream.raiseEvent("RealLustGotEvent",who))}));eventStream_eventStream.registerEvent("LustNoneEvent",(function lustLostAll(){rejectList=[]}));var sys_sys={settings:{sep:"|",overrideTab:!1,overrideUpDown:!1,customPrompt:!1,echoAffGot:!1,echoAffLost:!1,echoDefGot:!0,echoDefLost:!0,echoBalanceGot:!0,echoBalanceLost:!1,echoTrackableGot:!0,echoTrackableLost:!0,echoPrioritySet:!0,curingMethod:"Transmutation",sipHealthAt:80,sipManaAt:80,mossHealthAt:80,mossManaAt:80,focus:!0,focusOverHerbs:!0,tree:!0,clot:!0,clotAt:5,insomnia:!0,fracturesAbove:30,manaAbilitiesAbove:1,batch:!0},state:{paused:!1,slowMode:!1,sep:"|",overrideTab:!1,overrideUpDown:!1,customPrompt:!1,echoAffGot:!1,echoAffLost:!1,echoDefGot:!0,echoDefLost:!0,echoBalanceGot:!0,echoBalanceLost:!1,echoTrackableGot:!0,echoTrackableLost:!0,echoPrioritySet:!0,curingMethod:"Transmutation",sipPriority:"Health",sipHealthAt:80,sipManaAt:80,mossHealthAt:80,mossManaAt:80,focus:!0,focusOverHerbs:!0,tree:!0,clot:!0,clotAt:5,insomnia:!0,fracturesAbove:30,manaAbilitiesAbove:1,batch:!0},char:{class:"",race:"",color:"",h:5e3,m:5e3,e:2e4,w:2e4,xp:0,maxh:5e3,maxm:5e3,maxw:2e4,maxe:2e4,bleed:0,rage:0,kai:0,shin:0,stance:"",target:""},target:"",lifevision:!1,isPaused:function isPaused(){return this.state.paused},isSlowMode:function isSlowMode(){return this.state.slowMode},getClass:function getClass(){return this.char.class},isClass:function isClass(className){if(void 0===className)return!0;if(Array.isArray(className)){for(var i=0;i<className.length;i++)if(this.checkClass(className[i]))return!0;return!1}return this.checkClass(className)},checkClass:function checkClass(className){return this.getClass().toLowerCase()===className.toLowerCase()},setTarget:function setTarget(target){target=target.toProperCase(),eventStream_eventStream.raiseEvent("TargetSetEvent",target),this.target!==target&&(this.target=target,eventStream_eventStream.raiseEvent("TargetChanged",target)),eventStream_eventStream.raiseEvent("SystemOutputAdd","settarget "+target),set_current_target(target,!0)},isTarget:function isTarget(person){return void 0!==person&&this.target.toLowerCase()===person.toLowerCase()},pause:function pause(){this.state.paused=!0,eventStream_eventStream.raiseEvent("SystemPaused")},unpause:function unpause(){this.state.paused=!1,eventStream_eventStream.raiseEvent("SystemUnpaused")},pauseToggle:function pauseToggle(){this.isPaused()?this.unpause():this.pause()},slowOn:function slowOn(){this.state.slowMode=!0,eventStream_eventStream.raiseEvent("SystemSlowModeOn")},slowOff:function slowOff(){this.state.slowMode=!1,eventStream_eventStream.raiseEvent("SystemSlowModeOff")},slowToggle:function slowToggle(){this.isSlowMode()?this.slowOff():this.slowOn()},setSystemStatus:function setSystemStatus(status,arg){this.state[status]=arg,eventStream_eventStream.raiseEvent("SystemStatusSetEvent",{status:status,arg:arg})},toggleSystemStatus:function toggleSystemStatus(status){"Health"===this.state[status]?this.setSystemStatus(status,"Mana"):"Mana"===this.state[status]?this.setSystemStatus(status,"Health"):this.setSystemStatus(status,!this.state[status])}},sysLogging={locations:"console",logEvents:!1};var outputInProgress=!1,outputPending=!1,output=[],eventOutput=[],addToOutput=(new Balance("SystemOutput",1),function addToOutput(command){Array.isArray(command)?output=output.concat(command):output.push(command)}),sendOutput=function sendOutput(){if(output.length>0){eventStream_eventStream.raiseEvent("OutputSentEvent",output),addToOutput("echo SystemEvent SystemOutputCompleteEvent");for(var chunks=(output.length-1)/20+1,i=0;i<chunks;i++){sendCmd(output.slice(20*i,20*i+20).join(sys_sys.settings.sep))}outputInProgress=!0,eventOutput=[],eventStream_eventStream.raiseEvent("SystemOutputLostBalEvent")}},populateOutputFlag=!1,populateOutput=function populateOutput(){if(populateOutputFlag)if(outputInProgress||sys_sys.isPaused()||sys_sys.isSlowMode()||Affs.aeon.have)outputPending=!0;else{populateOutputFlag=!1,output=[],outputPending=!1;var affList=getCurrentAffs(),balList=function getCurrentBals(){var bals=Bals,currentBals=[];for(var _bal in bals)bals[_bal].have&&currentBals.push(bals[_bal].name);return currentBals}();addToOutput(function getCureOutputs(affList,balList){for(var cureOutputs=[],affCurable=!0;affCurable;){affCurable=!1;for(var i=0;i<affList.length&&!affCurable;i++)for(var aff=Affs[affList[i]],cures=aff.cures,j=0;j<cures.length;j++){var canPerform=!0,_cure=Cures[cures[j]];if(!_cure.isIgnored&&!Array.arraysIntersect(_cure.blocks,affList)){for(var k=0;k<_cure.balsReq.length&&canPerform;k++)-1===balList.indexOf(_cure.balsReq[k])&&(canPerform=!1);if(canPerform){for(var _k=0;_k<_cure.order.length&&canPerform;_k++)_cure.order[_k]!==aff.name&&affList.indexOf(_cure.order[_k])>=0&&(canPerform=!1);if(canPerform&&(cureOutputs=cureOutputs.concat(_cure.command),affCurable=!0,affList.splice(affList.indexOf(aff.name),1),0!==_cure.balsUsed.length&&"free"!==_cure.balsUsed[0]))for(var _k2=0;_k2<_cure.balsUsed.length;_k2++)balList.splice(balList.indexOf(_cure.balsUsed[_k2]),1)}}}}for(affCurable=!0;affCurable;){affCurable=!1;for(var _i=0;_i<affList.length&&!affCurable;_i++)for(var _aff=Affs[affList[_i]],_cures=_aff.cures,_j=0;_j<_cures.length;_j++){var _canPerform=!0,_cure2=Cures[_cures[_j]];if(!_cure2.isIgnored&&!Array.arraysIntersect(_cure2.blocks,affList)){for(var _k3=0;_k3<_cure2.balsReq.length&&_canPerform;_k3++)-1===balList.indexOf(_cure2.balsReq[_k3])&&(_canPerform=!1);if(_canPerform&&(cureOutputs=cureOutputs.concat(_cure2.command),affCurable=!0,affList.splice(affList.indexOf(_aff.name),1),"free"!==_cure2.balsUsed[0]))for(var _k4=0;_k4<_cure2.balsUsed.length;_k4++)balList.splice(balList.indexOf(_cure2.balsUsed[_k4]),1)}}}return cureOutputs}(affList,balList)),addToOutput(getLustCommands()),addToOutput(getDefOutputs(affList,balList)),addToOutput(getCacheOutputs(affList)),addToOutput(eventOutput),sendOutput()}};eventStream_eventStream.registerEvent("SystemOutputAdd",(function addToEventOutput(command){Array.isArray(command)?eventOutput=eventOutput.concat(command):eventOutput.push(command),forcePopulateOutput()}));var forcePopulateOutput=function forcePopulateOutput(){populateOutputFlag=!0,populateOutput()},flagPopulateOutput=function flagPopulateOutput(){populateOutputFlag=!0};eventStream_eventStream.registerEvent("balanceRecoveredEvent",populateOutput),eventStream_eventStream.registerEvent("equilibriumRecoveredEvent",populateOutput),eventStream_eventStream.registerEvent("PromptEvent",populateOutput),eventStream_eventStream.registerEvent("ForcePopulateEvent",forcePopulateOutput),eventStream_eventStream.registerEvent("AffGot",flagPopulateOutput),eventStream_eventStream.registerEvent("AffLost",flagPopulateOutput),eventStream_eventStream.registerEvent("DefGot",flagPopulateOutput),eventStream_eventStream.registerEvent("DefLost",flagPopulateOutput),eventStream_eventStream.registerEvent("BalanceGot",flagPopulateOutput),eventStream_eventStream.registerEvent("BalanceLost",flagPopulateOutput),eventStream_eventStream.registerEvent("AffPrioritySetEvent",flagPopulateOutput),eventStream_eventStream.registerEvent("DefPrioritySetEvent",flagPopulateOutput),eventStream_eventStream.registerEvent("PrioritySetEvent",flagPopulateOutput),eventStream_eventStream.registerEvent("RealLustGotEvent",flagPopulateOutput),eventStream_eventStream.registerEvent("RiftListCompleteEvent",forcePopulateOutput);eventStream_eventStream.registerEvent("SystemOutputGotBalEvent",(function outputComplete(balance){eventStream_eventStream.raiseEvent("OutputCompleteEvent",output),outputInProgress=!1,output=[],outputPending&&forcePopulateOutput()}));eventStream_eventStream.registerEvent("SystemOutputCompleteEvent",(function systemOutputComplete(){eventStream_eventStream.raiseEvent("SystemOutputGotBalEvent")})),eventStream_eventStream.registerEvent("stunLostAffEvent",sendOutput);eventStream_eventStream.registerEvent("Char.Vitals",(function setCharVitals(vitals){var sysChar=sys_sys.char,oh=sysChar.h,om=sysChar.m,oe=sysChar.e,ow=sysChar.w,omaxh=sysChar.maxh,omaxm=sysChar.maxm,omaxe=sysChar.maxe,omaxw=sysChar.maxw,orage=sysChar.rage,h=vitals.hp||oh,m=vitals.mp||om,e=vitals.ep||oe,w=vitals.wp||ow,maxh=vitals.maxhp||omaxh,maxm=vitals.maxmp||omaxm,maxe=vitals.maxep||omaxe,maxw=vitals.maxwp||omaxw,rage=parseInt(vitals.charstats[1].match(/(\d+)/g)[0]);sysChar.h=h,sysChar.m=m,sysChar.e=e,sysChar.w=w,sysChar.maxh=maxh,sysChar.maxm=maxm,sysChar.maxe=maxe,sysChar.maxw=maxw,sysChar.rage=rage,h!==oh&&eventStream_eventStream.raiseEvent("HealthUpdated",{max:maxh,current:h,diff:h-oh}),m!==om&&eventStream_eventStream.raiseEvent("ManaUpdated",{max:maxm,current:m,diff:m-om}),maxh!==omaxh&&eventStream_eventStream.raiseEvent("MaxHealthUpdated",{max:maxh,current:h,diff:maxh-omaxh}),maxm!==omaxm&&eventStream_eventStream.raiseEvent("MaxManaUpdated",{max:maxm,current:m,diff:maxm-omaxm}),rage!==orage&&eventStream_eventStream.raiseEvent("RageUpdated",{max:rage,current:rage,diff:rage-orage}),0===h?oh>0&&(sys_sys.pause(),eventStream_eventStream.raiseEvent("DiedEvent")):0===oh&&h>0&&(sys_sys.unpause(),eventStream_eventStream.raiseEvent("AliveEvent")),eventStream_eventStream.raiseEvent("SystemCharVitalsUpdated",sysChar)})),eventStream_eventStream.registerEvent("Char.Status",(function setCharStatus(status){var sysChar=sys_sys.char,otarget=sysChar.target,oclass=sysChar.class,orace=sysChar.race,oxp=sysChar.xp,curTarget=(status.target||otarget).split(" ")[0].toProperCase(),curClass=(status.class||oclass).toProperCase(),curRace=status.race||orace,curColor="";curRace.indexOf("Dragon")>=0&&(curClass="Dragon",curColor=curRace.split(" ")[0]);var xp=status.xp||oxp,gold=status.gold;sysChar.target=curTarget,sysChar.class=curClass,sysChar.race=curRace,sysChar.color=curColor,sysChar.xp=xp,sysChar.gold=gold,otarget!==curTarget?(sys_sys.target=curTarget,eventStream_eventStream.raiseEvent("TargetChanged",curTarget),eventStream_eventStream.raiseEvent("GameTargetChanged",{old:otarget,new:curTarget})):eventStream_eventStream.raiseEvent("TargetSetEvent",curTarget),oclass!==curClass&&eventStream_eventStream.raiseEvent("ClassChanged",{old:oclass,new:curClass}),eventStream_eventStream.raiseEvent("SystemCharStatusUpdated",sysChar)}));function echo_typeof(obj){return echo_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},echo_typeof(obj)}function echo_get(){return echo_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(target,property,receiver){var base=echo_superPropBase(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(arguments.length<3?target:receiver):desc.value}},echo_get.apply(this,arguments)}function echo_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=echo_getPrototypeOf(object)););return object}function echo_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&echo_setPrototypeOf(subClass,superClass)}function echo_setPrototypeOf(o,p){return echo_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},echo_setPrototypeOf(o,p)}function echo_createSuper(Derived){var hasNativeReflectConstruct=function echo_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=echo_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=echo_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return echo_possibleConstructorReturn(this,result)}}function echo_possibleConstructorReturn(self,call){if(call&&("object"===echo_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return echo_assertThisInitialized(self)}function echo_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function echo_getPrototypeOf(o){return echo_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},echo_getPrototypeOf(o)}function echo_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function echo_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function echo_createClass(Constructor,protoProps,staticProps){return protoProps&&echo_defineProperties(Constructor.prototype,protoProps),staticProps&&echo_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}eventStream_eventStream.registerEvent("PromptEvent",(function lifevisionCheck(){sys_sys.lifevision=!1}));var Echo=function(){function Echo(fg,bg,selector){echo_classCallCheck(this,Echo),this._fg=fg||"white",this._bg=bg,this._selector=selector||"#output_main",this.echo=this.echo.bind(this)}return echo_createClass(Echo,[{key:"echo",value:function echo(text){window.display_notice(this._selector,text,this._fg,this._bg)}}]),Echo}(),EchoLine=function(_Echo){echo_inherits(EchoLine,_Echo);var _super=echo_createSuper(EchoLine);function EchoLine(){return echo_classCallCheck(this,EchoLine),_super.apply(this,arguments)}return echo_createClass(EchoLine,[{key:"echo",value:function echo(text){echo_get(echo_getPrototypeOf(EchoLine.prototype),"echo",this).call(this,text)}}]),EchoLine}(Echo),EchoWithPrefix=function(_Echo2){echo_inherits(EchoWithPrefix,_Echo2);var _super2=echo_createSuper(EchoWithPrefix);function EchoWithPrefix(prefix,fg,bg,selector){var _this;return echo_classCallCheck(this,EchoWithPrefix),_this=_super2.call(this,fg,bg,selector),void 0!==prefix&&(_this._prefix=prefix.text,_this._prefixFg=prefix.fg,_this._prefixBg=prefix.bg),_this.echo=_this.echo.bind(echo_assertThisInitialized(_this)),_this}return echo_createClass(EchoWithPrefix,[{key:"echo",value:function echo(text){window.display_notice(this._selector,this._prefix,this._prefixFg,this._prefixBg,text,this._fg,this._bg)}}]),EchoWithPrefix}(Echo),EchoLinePrefix=function(_EchoWithPrefix){echo_inherits(EchoLinePrefix,_EchoWithPrefix);var _super3=echo_createSuper(EchoLinePrefix);function EchoLinePrefix(){return echo_classCallCheck(this,EchoLinePrefix),_super3.apply(this,arguments)}return echo_createClass(EchoLinePrefix,[{key:"echo",value:function echo(text){echo_get(echo_getPrototypeOf(EchoLinePrefix.prototype),"echo",this).call(this,text)}}]),EchoLinePrefix}(EchoWithPrefix),selector="#output_main",TrackableEchoGot=new EchoLinePrefix({text:" + ",fg:"white"},"green","",selector),TrackableEchoLost=new EchoLinePrefix({text:" - ",fg:"white"},"red","",selector),AffEchoGot=new EchoLinePrefix({text:" +aff ",fg:"orange"},"green","",selector),AffEchoLost=new EchoLinePrefix({text:" -aff ",fg:"orange"},"red","",selector),DefEchoGot=new EchoLinePrefix({text:" +def ",fg:"purple"},"green","",selector),DefEchoLost=new EchoLinePrefix({text:" -def ",fg:"purple"},"red","",selector),BalanceEchoGot=new EchoLinePrefix({text:" onBal ",fg:"brown"},"green"),BalanceEchoLost=new EchoLinePrefix({text:" offBal ",fg:"brown"},"red"),PrioritySetEcho=new EchoLinePrefix({text:"priority change: ",fg:"yellow"},"red","",selector);eventStream_eventStream.removeListener("TrackableGot","gotTrackable"),eventStream_eventStream.removeListener("TrackableLost","lostTrackable"),eventStream_eventStream.removeListener("AffGot","gotAff"),eventStream_eventStream.removeListener("AffLost","lostAff"),eventStream_eventStream.removeListener("DefGot","gotDef"),eventStream_eventStream.removeListener("DefLost","lostDef"),eventStream_eventStream.removeListener("BalanceGot","gotBalance"),eventStream_eventStream.removeListener("BalanceLost","lostBalance"),eventStream_eventStream.removeListener("PrioritySetEvent","prioritySet"),eventStream_eventStream.registerEvent("TrackableGot",(function gotTrackable(data){sys_sys.settings.echoTrackableGot&&TrackableEchoGot.echo(data.name)})),eventStream_eventStream.registerEvent("TrackableLost",(function lostTrackable(data){sys_sys.settings.echoTrackableLost&&TrackableEchoLost.echo(data.name)})),eventStream_eventStream.registerEvent("AffGot",(function gotAff(data){sys_sys.settings.echoAffGot&&AffEchoGot.echo(data.name)})),eventStream_eventStream.registerEvent("AffLost",(function lostAff(data){sys_sys.settings.echoAffLost&&AffEchoLost.echo(data.name)})),eventStream_eventStream.registerEvent("DefGot",(function gotDef(data){sys_sys.settings.echoDefGot&&DefEchoGot.echo(data.name)})),eventStream_eventStream.registerEvent("DefLost",(function lostDef(data){sys_sys.settings.echoDefLost&&DefEchoLost.echo(data.name)})),eventStream_eventStream.registerEvent("BalanceGot",(function gotBalance(data){["equilibrium","balance"].includes(data.name)?window.display_notice("You have recovered "+data.name,"#00ccff","black"," ("+data.duration.toFixed(2)+")","#33cc33","black"):sys_sys.settings.echoBalanceGot&&"SystemOutput"!==data.name&&BalanceEchoGot.echo(data.name+"("+data.duration.toFixed(2)+")")})),eventStream_eventStream.registerEvent("BalanceLost",(function lostBalance(data){sys_sys.settings.echoBalanceLost&&BalanceEchoLost.echo(data.name)})),eventStream_eventStream.registerEvent("PrioritySetEvent",(function prioritySet(data){sys_sys.settings.echoPrioritySet&&PrioritySetEcho.echo(data.name+" "+data.prio)}));var SystemOutputDisplay=new Echo("red");eventStream_eventStream.registerEvent("OutputSentEvent",(function systemOutputSentDisplay(output){SystemOutputDisplay.echo("("+output.join("|")+")")}));var DorEchoStart=new EchoLinePrefix({text:"[dor]: ",fg:"green"},"white"),DorEchoStop=new EchoLinePrefix({text:"[dor]: ",fg:"red"},"white"),DorEchoExecuted=new EchoLinePrefix({text:"[dor]: ",fg:"green"},"white");eventStream_eventStream.registerEvent("DorDoRepeatStartedEvent",(function doRepeatStartedDisplay(dor){DorEchoStart.echo("Looping "+dor.command+" every "+dor.length+" seconds")}));eventStream_eventStream.registerEvent("DorDoRepeatStoppedEvent",(function doRepeatStoppedDisplay(dor){DorEchoStop.echo("Stopped repeating")}));eventStream_eventStream.registerEvent("DorDoRepeatExecutedEvent",(function doRepeatExecutedDisplay(dor){DorEchoExecuted.echo(dor.command)})),void 0===window.GMCP&&(window.GMCP={});var curRoom=0,curRoomName="",curArea="",curRoomArea="";GMCP.Items={room:[],inv:[]};eventStream_eventStream.registerEvent("Room.Info",(function roomChangeCheck(args){curRoom!==args.num&&(curRoom=args.num,curRoomName=args.name,curArea=args.area,curRoomArea=args.name+" ("+args.area+")",eventStream_eventStream.raiseEvent("RoomChangedEvent",args))}));eventStream_eventStream.registerEvent("Char.Items.Add",(function addedItem(args){"room"===args.location?(window.GMCP.Items.room.push(args.item),eventStream_eventStream.raiseEvent("ItemAddedToRoom",args.item)):"inv"===args.location&&(window.GMCP.Items.inv.push(args.item),eventStream_eventStream.raiseEvent("ItemAddedToInv",args.item))}));eventStream_eventStream.registerEvent("Char.Items.Remove",(function removedItem(args){"room"===args.location?(window.GMCP.Items.room.splice(window.GMCP.Items.room.findIndex((function(e){return e.id===args.item.id})),1),eventStream_eventStream.raiseEvent("ItemRemovedFromRoom",args.item)):"inv"===args.location&&(window.GMCP.Items.inv.splice(GMCP.Items.inv.findIndex((function(e){return e.id===args.item.id})),1),eventStream_eventStream.raiseEvent("ItemRemovedFromInv",args.item))}));eventStream_eventStream.registerEvent("Char.Items.Update",(function updatedItem(args){"room"===args.location?(window.GMCP.Items.room[window.GMCP.Room.items.findIndex((function(e){return e.id===args.item.id}))]=args.item,eventStream_eventStream.raiseEvent("ItemUpdatedRoom",args.item)):"inv"===args.location&&(window.GMCP.Items.inv[window.GMCP.Items.inv.findIndex((function(e){return e.id===args.item.id}))]=args.item,eventStream_eventStream.raiseEvent("ItemUpdatedInv",args.item))}));function queue_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}eventStream_eventStream.registerEvent("Char.Items.List",(function listItems(args){"room"===args.location?(window.GMCP.Items.room=args.items,eventStream_eventStream.raiseEvent("ItemListForRoom",args.items)):"inv"===args.location&&(window.GMCP.Items.inv=args.items,eventStream_eventStream.raiseEvent("ItemListForInv",args.items))}));var Queue=function(){function Queue(obj){!function queue_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Queue),this._name=obj.name,this._prefix=obj.prefix||"",this._pre=obj.pre||"",this._clear=obj.clear||"",this._queue=[],this._prepend=[],this._gagged=!1;eventStream_eventStream.registerEvent(this._name+"QueueFired",(function queueFired(queue){queue.clear()}))}return function queue_createClass(Constructor,protoProps,staticProps){return protoProps&&queue_defineProperties(Constructor.prototype,protoProps),staticProps&&queue_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Queue,[{key:"queue",get:function get(){return this._queue}},{key:"isQueued",value:function isQueued(cmd){return-1!==this._queue.indexOf(cmd)||-1!==this._prepend.indexOf(cmd)}},{key:"add",value:function add(cmd){var tempQ=Array.isArray(cmd)?cmd:cmd.split(sys_sys.settings.sep);Array.equals(tempQ,this._queue)||(this._queue=tempQ,this.send())}},{key:"prepend",value:function prepend(cmd){var tempQ=Array.isArray(cmd)?cmd:cmd.split(sys_sys.settings.sep);Array.equals(tempQ,this._prepend)||(this._prepend=this._prepend.concat(tempQ),this.send())}},{key:"send",value:function send(){var tempQueue=this._prepend.concat(this._queue);tempQueue.length<1||(this._pre&&tempQueue.unshift(this._pre),tempQueue[0]=this._prefix+tempQueue[0],sendInline(tempQueue))}},{key:"clearQueue",value:function clearQueue(){this._queue=[],this._prepend=[],sendCmd(this._clear),eventStream_eventStream.raiseEvent(this._name+"QueueCleared",this)}},{key:"clear",value:function clear(){this._queue=[],this._prepend=[]}}]),Queue}(),updateList=function updateList(list,newList){if(newList)for(var i=0;i<newList.length;i++)list.includes(newList[i])||list.push(newList[i])},updateModel=function updateModel(model,newModel){if(newModel)for(var key in newModel)model[key]=newModel[key];else console.log(model+" model was null in updateModel")},saveModel=function saveModel(name,model){model?(nexusclient.variables().set(name,model),eventStream_eventStream.raiseEvent(name+"ModelSavedEvent",model)):console.log(name+" model was null in saveModel")},updateAndSaveModel=function updateAndSaveModel(name,model,newModel){updateModel(model,newModel),saveModel(name,model)};window.eventStream=eventStream_eventStream;var nexsys_nexSys={sys:sys_sys,sysLogging:sysLogging,sysLog:function sys_sysLog(text){"console"===sysLogging.locations&&console.log(text)},sysLoggingToggle:function sysLoggingToggle(enable){sysLogging.logEvents="on"===enable},Cures:Cures,Affs:Affs,getCurrentAffs:getCurrentAffs,haveAff:haveAff,haveAffs:function haveAffs(affs){if(void 0===affs)return!1;if(Array.isArray(affs)){for(var _i2=0;_i2<affs.length;_i2++)if(!haveAff(affs[_i2]))return!1;return!0}return haveAff(affs)},haveAnAff:function haveAnAff(affs){if(void 0===affs)return!1;if(Array.isArray(affs)){for(var _i3=0;_i3<affs.length;_i3++)if(haveAff(affs[_i3]))return!0;return!1}return haveAff(affs)},affPrioSwap:function affPrioSwap(aff,prio){var curAff=Affs[aff];void 0===aff||void 0===curAff||curAff.set_prio(prio)},Bals:Bals,haveABal:function haveABal(bals){if(void 0===bals)return!1;if(Array.isArray(bals)){for(var i=0;i<bals.length;i++)if(haveBal(bals[i]))return!0;return!1}return haveBal(bals)},haveBal:haveBal,haveBals:function haveBals(bals){if(void 0===bals)return!1;if(Array.isArray(bals)){for(var i=0;i<bals.length;i++)if(!haveBal(bals[i]))return!1;return!0}return haveBal(bals)},Defs:Defs,getCurrentDefs:function getCurrentDefs(){var defs=Defs,current_defs=[];for(var _def in defs)defs[_def].have&&current_defs.push(defs[_def].name);return current_defs},getDefOutputs:getDefOutputs,getMissingDefs:getMissingDefs,Caches:Caches,getCacheOutputs:getCacheOutputs,getMissingCache:getMissingCache,echo:new Echo("white"),echoLine:new EchoLine("white"),echoInfoLine:new EchoLinePrefix({text:"[Info]: ",fg:"yellow"},"white"),gmcpHandler:function gmcpHandler(){for(;nexSys.gmcpBackLog&&nexSys.gmcpBackLog.length>0;){var current_args=nexSys.gmcpBackLog.shift();current_args.gmcp_method&&(Object.setAtString(window.GMCP,current_args.gmcp_method.split("."),current_args.gmcp_args),eventStream_eventStream.raiseEvent(current_args.gmcp_method,current_args.gmcp_args))}},curArea:curArea,curRoom:curRoom,curRoomArea:curRoomArea,curRoomName:curRoomName,limbs:limbs,dirs:["e","w","s","n","ne","se","sw","nw","in","out","d","u"],dirMap:{e:"east",w:"west",s:"south",n:"north",ne:"northeast",se:"southeast",sw:"southwest",nw:"northwest",in:"in",out:"out",down:"down",d:"down",u:"up",up:"up"},oppdirs:{e:"west",w:"east",s:"north",n:"south",ne:"southwest",se:"northwest",sw:"northeast",nw:"southeast",in:"out",out:"in",down:"up",d:"up",u:"down",up:"down"},shortDirs:{east:"e",west:"w",south:"s",north:"n",northeast:"ne",northwest:"nw",southeast:"se",southwest:"sw",in:"in",out:"out",down:"d",up:"up"},whiteList:whiteList,rejectList:rejectList,getLustCommands:getLustCommands,sendCmd:sendCmd,psend:psend,rsend:function rsend(what){sys_sys.isSlowMode()||psend(what)},timeDiffNow:function timeDiffNow(prev){return(performance.now()-prev)/1e3},sendInline:sendInline,serversideSettings:serversideSettings,serversideDefencePriorityListStart:!1,eqbalQueue:new Queue({name:"eqBal",prefix:"queue addclear eqbal ",pre:!1,clear:"clearqueue eqbal"}),classQueue:new Queue({name:"class",prefix:"queue addclear class ",pre:!1,clear:"clearqueue class"}),updateModel:updateModel,updateList:updateList,saveModel:saveModel,updateAndSaveModel:updateAndSaveModel,loadCustomSettings:function loadCustomSettings(){!function loadSystemSettings(){var model=nexusclient.variables().get("CustomSystemSettings");updateAndSaveModel("CustomSystemSettings",sys_sys.settings,model)}(),function loadAffSettings(){var model=nexusclient.variables().get("CustomAffSettings");model&&(updateList(affs.list,model.list),updateModel(affs.prios,model.prios),model.types&&(updateModel(affs.types.defs,model.types.defs),updateModel(affs.types.countable,model.types.countable),updateModel(affs.types.timed,model.types.timed),updateModel(affs.types.unknown,model.types.unknown),updateModel(affs.types.uncurable,model.types.uncurable))),saveModel("CustomAffSettings",affs)}(),function loadDefTable(){var model=nexusclient.variables().get("CustomDefTable");updateAndSaveModel("CustomDefTable",defTable,model)}(),function loadDefSettings(){var model=nexusclient.variables().get("CustomDefSettings");model&&(updateModel(defTable_defPrios.keepup,model.keepup),updateModel(defTable_defPrios.static,model.static)),saveModel("CustomDefSettings",defTable_defPrios)}(),function loadBalanceTable(){var model=nexusclient.variables().get("CustomBalanceTable");updateAndSaveModel("CustomBalanceTable",balances,model)}(),function loadCacheSettings(){var model=nexusclient.variables().get("CustomCacheSettings");updateAndSaveModel("CustomCacheSettings",cacheTable,model)}(),function loadCureTable(){var model=nexusclient.variables().get("CustomCureTable");updateAndSaveModel("CustomCureTable",cures,model)}(),function loadLustList(){whiteList=nexusclient.variables().get("LustWhiteList")||whiteList,saveModel("LustWhiteList",whiteList)}()},saveCustomSettings:function saveCustomSettings(){saveModel("CustomSystemSettings",sys_sys.settings),saveModel("CustomAffSettings",affs),saveModel("CustomDefTable",defTable),saveModel("CustomDefSettings",defTable_defPrios),saveModel("CustomBalanceTable",balances),saveModel("CustomCacheSettings",cacheTable),saveModel("CustomCureTable",cures),saveModel("LustWhiteList",whiteList)}};!function serverside(){var serversideCuringStatusMap={curingMethod:"transmutation",sipPriority:"priority",sipHealthAt:"siphealth",sipManaAt:"sipmana",mossHealthAt:"mosshealth",mossManaAt:"mossmana",focus:"focus",focusOverHerbs:"focus",tree:"tree",clot:"clot",clotAt:"clotat",insomnia:"insomnia",fracturesAbove:"healthaffsabove",manaAbilitiesAbove:"manathreshold",batch:"batch"};eventStream_eventStream.registerEvent("SystemPaused",(function(args){sendCmd("curing off")})),eventStream_eventStream.registerEvent("SystemUnpaused",(function(args){sendCmd("curing on")})),eventStream_eventStream.registerEvent("SystemSlowModeOn",(function serversideSlowModeOn(args){sendInline(["curing siphealth 30","curing sipmana 10","curing mosshealth 0","curing mossmana 0","curing batch off","curing clotat 5000"])})),eventStream_eventStream.registerEvent("SystemSlowModeOff",(function serversideSlowModeOff(args){var settings=sys_sys.state;sendInline(["curing siphealth "+settings.sipHealthAt,"curing sipmana "+settings.sipManaAt,"curing mosshealth "+settings.mossHealthAt,"curing mossmana "+settings.mossManaAt,"curing batch on","curing clotat "+settings.clotAt])})),eventStream_eventStream.registerEvent("DefPrioritySetEvent",(function serversideDefencePrio(def){def instanceof AffDef?def.isServerSide&&def.prio!==serversideSettings.defs[def.name]&&(def.isIgnored?(serversideSettings.defs[def.name]=void 0,eventStream_eventStream.raiseEvent("SystemOutputAdd","curing priority defence "+def.name+" reset")):(serversideSettings.defs[def.name]=def.prio,eventStream_eventStream.raiseEvent("SystemOutputAdd","curing priority defence "+def.name+" "+def.prio))):def.isServerSide&&def.prio!==serversideSettings.defs[def.name]&&(def.isIgnored&&void 0===serversideSettings.defs[def.name]||(def.isIgnored?(serversideSettings.defs[def.name]=void 0,eventStream_eventStream.raiseEvent("SystemOutputAdd","curing priority defence "+def.name+" reset")):def.preempt?(serversideSettings.defs[def.name]=def.prio,eventStream_eventStream.raiseEvent("SystemOutputAdd","curing priority defence "+def.name+" "+def.prio+" preempt")):(serversideSettings.defs[def.name]=def.prio,eventStream_eventStream.raiseEvent("SystemOutputAdd","curing priority defence "+def.name+" "+def.prio))))})),eventStream_eventStream.registerEvent("AffPrioritySetEvent",(function serversideAffPrio(aff){if(aff.isServerSide&&aff.prio!==serversideSettings.affs[aff.name]){var prio=aff.prio;0===prio||26===prio?(serversideSettings.affs[aff.name]=26,eventStream_eventStream.raiseEvent("SystemOutputAdd","curing priority "+aff.name+" 26")):(serversideSettings.affs[aff.name]=prio,eventStream_eventStream.raiseEvent("SystemOutputAdd","curing priority "+aff.name+" "+prio))}})),eventStream_eventStream.registerEvent("SystemStatusSetEvent",(function serversideSetStatus(args){var status=args.status,arg=args.arg;!0===arg?arg="on":!1===arg?arg="off":"Transmutation"===arg?arg="on":"Concoctions"===arg&&(arg="off"),"focusOverHerbs"===status&&(arg=arg?"first":"second"),eventStream_eventStream.raiseEvent("SystemOutputAdd","curing "+serversideCuringStatusMap[status]+" "+arg)}));var separatorSet=!1,initiateStartup=function initiateStartup(args){if(!separatorSet){separatorSet=!0,args&&(sys_sys.settings.sep=args,nexusclient.variables().set("commandSeparator",args)),sys_sys.pause();for(var startupCommands=["inr all","score","curing defences on","curing afflictions on","curing status","curing priority list","curing priority defence list","def","echo SystemEvent CuringStartupCompleteEvent"],i=0;i<startupCommands.length;i++)sendCmd(startupCommands[i]);nexusclient.datahandler().send_GMCP("IRE.Rift.Request","")}};eventStream_eventStream.registerEvent("CommandSeparatorSetOnStartup",initiateStartup),eventStream_eventStream.registerEvent("SystemLoaded",(function systemStartupServerside(){serversideSettings={loaded:!1,status:{},affs:{},defs:{}};var separator=sys_sys.settings.sep;sys_sys.pause(),separator?initiateStartup(!1):echo("Enter commandSeparator to get started (e.g. 'config commandseparator |')")})),eventStream_eventStream.registerEvent("CuringStatusEvent",(function curingStatus(args){var statusProperty=args.status,arg=args.arg;"Yes"===arg?arg=!0:"No"===arg&&(arg=!1),serversideSettings.status[statusProperty]=arg})),eventStream_eventStream.registerEvent("CuringPriorityAffsEvent",(function curingPriorityAffs(args){for(var prio=26===args.prio?0:args.prio,affs=args.affs.split(", "),i=0;i<affs.length;i++){var aff=affs[i];""!==aff&&(serversideSettings.affs[aff]=prio)}})),eventStream_eventStream.registerEvent("CuringPriorityDefsEvent",(function curingPriorityDefs(args){var defs=Defs,prio=args.prio,defname=args.def;if(defname.length>=15){for(var def in defs)if(def.startsWith(defname)){serversideSettings.defs[def]=prio;break}}else serversideSettings.defs[defname]=prio})),eventStream_eventStream.registerEvent("ServersideCuringStatusSetEvent",(function serversideCuringStatusSet(args){var arg=args.arg;"activated"===arg?arg=!0:"disabled"===arg&&(arg=!1),serversideSettings.status[args.status]=args.arg})),eventStream_eventStream.registerEvent("ServersideAffPrioritySetEvent",(function serversideAffPrioSet(args){serversideSettings.affs[args.aff]=args.prio})),eventStream_eventStream.registerEvent("ServersideDefPrioritySetEvent",(function serversideDefPrioSet(args){serversideSettings.defs[args.def]=args.prio})),eventStream_eventStream.registerEvent("CuringStartupCompleteEvent",(function curingStartupComplete(args){serversideSettings.loaded=!0,eventStream_eventStream.raiseEvent("ServersideSettingsCaptured"),sys_sys.unpause()})),eventStream_eventStream.registerEvent("ServersideSettingsCaptured",(function setCuringStatusVars(){for(var status in serversideSettings.status){var curStatus=serversideSettings.status[status],systemStatus=sys_sys.state[status];curStatus!==systemStatus&&sys_sys.setSystemStatus(status,systemStatus)}}))}();var nexsys=nexsys_nexSys;window.nexSys=nexsys,window.eventStream=eventStream_eventStream}();